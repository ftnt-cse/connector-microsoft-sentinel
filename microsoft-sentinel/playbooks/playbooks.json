{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Microsoft Sentinel - 1.0.0",
      "description": "Sample playbooks for \"Microsoft Sentinel\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "data:png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABHNCSVQICAgIfAhkiAAACcRJREFUeF7tm3mMnGUdx79z7Zx7lG6720u2rT1oS2HpBaXY1npBjEZriCZYDP+ggCiCoEQ0EZEoSaNJJZrYqvgH2gSJJiRa00Mp1doTWugJdHvufc29M++M398zO93D3dmZfXnnMM/Tbmc3+z4z7/t5v7/j+T5vbWkO6DFpAjYNcNLs1EQN0Bw/DdAkPw1QAzRLwOR8nQM1QJMETE7XCtQATRIwOV0rUAM0ScDkdK1ADdAkAZPTtQI1QJMETE7XCtQATRIwOV0r8P8VoGw0pGSzwab+wi7/lOEoKwUOGMDloIGWPgPtkRRCA2kFscphQ53bhhkBO+bVOTDVa4etTICWDcBroRRefieG/ZcSeJ8AQwMpDAqQrzY47UA9wd001YHPLPDgE3NdcDtLT7HkAFOU2IGrSTy7P4wLBBeoAhp9dr7a4CA0QZTi10AS6ImnIKDtlN8986vw+Bo/Gv08qISjJAAlv8WNNNrCaew8FcXvT8YwwJ8/PIXhSXgZXY2lrjQSBH6h10Ar5y6pd+LrK31YPcNJ4Hal0mIPywGGE2mVy+LJNOT7vniaKjJwsiOJfQzXq8EU6jw2zK62wZOV3AQU5AZ0RQ1cCTJHEvTKRifWznap/ChhXs186XEAXpcdtfyeKdSyYSnA7mga29+M4nh7AjGGYIQA+xmG/QQq+/k1vDgpDtVuOy+ysKvkO6ib0hvjF2+KvL/HCQKzo8ZjVwDr+PrlZR7cOctlWdGxFOC5bgMP/S2oFNfgz+Q0F/sRyf0OvsrPQ+1JYQAzkpIbkWl3kvzGYLKUEJfXKIF2RNJ4hCH+tWYPw3sy7z+xcC0FeKbLwMO7giwAKUzzUxJFHEmCbOk3sGWZF48SolX5sSgAY4kU6n35A5Sc5XZl+j+JbFGUhKv0ifk+ySMALzO/Sgh/Y1WFAwzzyqdOAFACrNZrQ9NUJ2bVOVHN/DUEkPmO+bMrnEJLdxKXepIKZq4hAK+F0grgNysdYFAASlYfZ1Qx+a/8UBWa51TB73ao3JgdNkow+wCZNNZJtjvtXK28fj6GC0wR4ylSAWSrs4UAH1td4QrsixuYQjCjh4Caw95vw0IPX50M1/wTfZxp4cjFOA61DKCP1X70MEi2lYq9/2YvvlXpAHtjBtuLkQCF1RL2b+u5LJte7SgInqq/BJSgGk+1JrD7dAx9bGeGD4MK7IhmcuDjBOiyqBksShHpZtNbMwrg7Do7Pn+rD9MChcPLghKIEqpvX03gtbejiCaGEArATipzy80ePLHaW8EA2Qd2KoBDiS3gBu5fE8DM2rHDNkUwPWEDV7k2lupbx+WdHOt1SVUeGeYCUY7fezaGfefiGQuMQwB2KQV68eTtFaxAaaQ7I0muVTMhLHlvwwI3Pr7YOwKGCkm2Kxe7E3jj3TjOcamXGKy0gqyGFXoli8wKFpsp7CnFUBg+OkNJ7DwawcWeTGGRHNgTI0DmwKcEYKU20gKwPTwEsLHGjntv87FosNEbNqS6HrkUV0rq5gqihm7MnGo7LSu6MMxv0tPxECyc7sSnbvJgxij1Sj58/d0Ydp+hMcFViACUJZ7kwO/c4SfAnF3PpH9peQ4UgG1Uh48KFBGsooI+TVX46Z4Mz2XnOxL4IxXUz7y1eqYDX1jsocGQ6QWD9AaPtxn4w6kYWtnbLW5w4osrfKrlGf4e73UmsPNYFB20vCSsxbiQHFjxAK8pgKIm+nhUz7r5HrUWzo44l3rbD4RwrjOJtTOd+DZDbhYrs4xsH8hDsJcty9ZDEYhJsZkFaO1c9/U0ICmgnyH78uEwTjP8xWfMAPTi6bUVqsCzNBMepgIv9yfhYQzV0La6t9mH5TOrRlz4Ba4utv0ziGqG7ZNrfNjUVDUCcBZ0H52crQcjeO29ASygF/jA7QF4hylZbsQrxyM4SNBSnUOsyl+pZAWKw/zo30M4zdASby5A6+qzzEnNc9zX7SvJXXvORfHXU3EsrXfg2Y/4la83VlMtYbmTYfyzQ1GulW3YssqPphsylVzsrTABv/pWFMeuJNSKJcoK/ghDXUzXijQTZGPou3tD2HdxAD6Gr51he4NPvuzXq6gopY0FIshwa25w4MfrA5hdM/ayT8L0L2xVnv9XRNlVDdxkkuosf8Ta4oIHrXRgpB80UpIHgWfWBfClJR7LdvUsLSJioL5wMIyX3ooxhLMXOn7Bm8/m+rn1fiydNnZ/KLB30KD95THZAshdOAdo4Yi5uvVjAdzF9seqYSlAUcCfzsTxw/0h1RDbVeEdf73rZ2fz4K1e3MfmV5rm4UPUJynhR2+E8W9uQmUb5rHBZKyv2xpdeOGjATTV5m+lFQraUoByMme7knhsdwjvsMJmuo7chkFTrR0P0kG+e55H9YDZKiz7xTvejOHPDOHIsCXbWBcssKVnfOAWH71AtkyjbkahkHIdbzlAUd7W/0Tw4lEmfgJU3UsO10V+Xc+8toJGwyrutkkYivL2X07gDKu65L6cQ5kMoAPO8N0UwDoLw1fJoRj/2fA8L3zzq33o5drURYiF2FaFqkXWwOy7VSP+/AY/vBZvvhcFoKxNt7O9+Amrp7QtylnK3/rLjyE/Q3wECd0Gqu/X91Rj+fSRy8X83qiwo4oCUE4pyK3MJ/aEsItNsOSoArzT/K5Idud4pCjuqTt8yki1yD8YcT5FAyifevhaEk//I8jG2lAX90FCZNsHG6v85kVu/OCugDIjijGKClD6uFfY1jx3IIIe5sMPCmJ2b1i1LSwcC7lNUKxRVIByUdJcS0X+FV0TeT7GlnXiJyOYwbwnbzGP0L5/px8bb6wqSuhmb1DRAcoH99I1efFoDL87ITb8IMFCAQ7Ck/eT5wa/R3h3z3db5vuNp+iSAMwqcduRCJ+diSlVqp6qAIgStjJLPMOfbqzmw0VOyx7fyJUOSgYwW5l/QRP1t1wrh+WBo8EzHY/j6M3LG7lEe4bK++RcsceKlfVGfk5JAWYhvnQihh3sE9u4j5vPkOKzjIaDbJhvpMNtlVWVz7mUHKCcpNhQu96P02WJ4kR7bqNA9qY2sVA8RJ/vFu6PFKPXK9sQHn5i8gDRSRoOP6dlv0c5yv972rI1et9SD00CT8kf7S1pFc51R2UnbdvhiHrsN0IjQoqFpLeGgI0b5H58bhFdmuK1eRNGcVmE8OizlPWsqPA3LC4tvUksb3Dhq81eLFdG64TXVNQDyhJglsAl2vNXaPcv4n9tmMLH3cpxlDXAcgQ2+pw0QJN3SQPUAE0SMDldK1ADNEnA5HStQA3QJAGT07UCNUCTBExO1wrUAE0SMDldK1ADNEnA5HStQA3QJAGT07UCNUCTBExO1wo0CfC/TvxJXIpUX7cAAAAASUVORK5CYII=",
      "uuid": "8589641d-44c6-4319-b1ee-46d286522fe3",
      "id": 60,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Microsoft Sentinel > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "This playbook demonstrate the list incidents operation.",
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672998460,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7d66e025-ffba-4976-ac8a-e665b648de48",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Incident Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.List_Incidents.data}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "incidentdata": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/ed191c7c-2cfb-4cea-bd10-36a9736d22f9"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "a7b2cf46-eb3e-441e-9401-d7b294ddd166"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Incidents",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/e2a70cf7-339e-4886-8cbd-3bd7c0fa8131"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "468e92f7-a495-4343-8773-be37b1cabb2c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "87c6f06e-b3e9-4cfc-a783-2941f633b446",
                "title": "Microsoft Sentinel > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7d66e025-ffba-4976-ac8a-e665b648de48"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Incident Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.List_Incidents.macro_name}}",
                  "value": "{{vars.steps.List_Incidents.curr_timestamp}}"
                },
                "version": "3.2.2",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "bcf40959-ead6-4a6a-9093-78bbaf4a4a86"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Incident Alert -> Update Last Incident Pull Time",
              "targetStep": "/api/3/workflow_steps/bcf40959-ead6-4a6a-9093-78bbaf4a4a86",
              "sourceStep": "/api/3/workflow_steps/a7b2cf46-eb3e-441e-9401-d7b294ddd166",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "cf803855-42a7-4e72-a5e4-275404139ca4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Incidents -> Fetch Incident Alert",
              "targetStep": "/api/3/workflow_steps/a7b2cf46-eb3e-441e-9401-d7b294ddd166",
              "sourceStep": "/api/3/workflow_steps/468e92f7-a495-4343-8773-be37b1cabb2c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4dfbb757-0eeb-4f74-ad18-047524179b93"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Incidents",
              "targetStep": "/api/3/workflow_steps/468e92f7-a495-4343-8773-be37b1cabb2c",
              "sourceStep": "/api/3/workflow_steps/7d66e025-ffba-4976-ac8a-e665b648de48",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f55b751c-6dab-4339-a2d6-a68b93f5a300"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "0e293e25-6b66-4d0d-afe2-bd3f3e1c7b2d",
          "id": 730,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Threat Intelligence Indicator",
          "aliasName": null,
          "tag": null,
          "description": "Updates a specific threat intelligence indicator in Microsoft Sentinel based on the threat intelligence indicator ID, workspace subscription ID, workspace resource group, workspace name and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1677047489,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2f10bc55-036f-44a9-9395-ad1602e667be",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "86ab936b-7c44-43eb-b40e-1fba93afec98",
                "title": "Microsoft Sentinel: Update Threat Intelligence Indicator",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "2f10bc55-036f-44a9-9395-ad1602e667be"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Threat Intelligence Indicator",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "id": "9bc3b4e6-d9d9-b35d-884c-f04c6f793c11",
                  "labels": "",
                  "source": "Microsoft Sentinel",
                  "pattern": "1.1.1.1",
                  "confidence": "",
                  "description": "",
                  "displayName": "New Indicator",
                  "patternType": "IPV4 Address",
                  "threatTypes": "",
                  "indicatorTypes": "",
                  "additional_fields": "",
                  "threatIntelligenceTags": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_threat_intelligence_indicator",
                "operationTitle": "Update Threat Intelligence Indicator",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e2053554-c107-4e5d-8733-43ad84adec32"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Threat Intelligence Indicator",
              "targetStep": "/api/3/workflow_steps/e2053554-c107-4e5d-8733-43ad84adec32",
              "sourceStep": "/api/3/workflow_steps/2f10bc55-036f-44a9-9395-ad1602e667be",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "fded3739-3628-4c1e-9079-9c8f94f15d5b"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "21d735d8-0d07-4df6-9add-66cfcae2ce26",
          "id": 695,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Watchlist",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a specific watchlist without watchlist items from Microsoft Sentinel based on the watchlist alias, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672638569,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1a38e5a9-78de-4a6d-bf44-ae44d4a89a43",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Watchlist",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "watchlistAlias": "highValueAsset"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_watchlist",
                "operationTitle": "Get Watchlist",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a7561092-f4b2-4624-82c8-32b7222eea82"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "be0aab58-52b4-4532-833b-2e883e4208a5",
                "title": "Microsoft Sentinel: Get Watchlist",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1a38e5a9-78de-4a6d-bf44-ae44d4a89a43"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Watchlist",
              "targetStep": "/api/3/workflow_steps/a7561092-f4b2-4624-82c8-32b7222eea82",
              "sourceStep": "/api/3/workflow_steps/1a38e5a9-78de-4a6d-bf44-ae44d4a89a43",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0e9d6ac5-f6f8-4348-ad6c-46bbc2642392"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "38c7fcb0-16a2-4ae9-b10b-b38d93cae0dc",
          "id": 696,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get All Incident Relations",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all incident relations from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace resource group, workspace name, and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672206705,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/02d04e17-d3f2-4c9d-820e-f8cb00b69256",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Incident Relations",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$top": "",
                  "$filter": "",
                  "$orderby": "",
                  "$skipToken": "",
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_incident_relations",
                "operationTitle": "Get All Incident Relations",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "44072ece-0382-4566-82fb-df09f84e7213"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "762035a6-497e-48d5-831f-799285d86c05",
                "title": "Microsoft Sentinel: Get All Incident Relations",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "02d04e17-d3f2-4c9d-820e-f8cb00b69256"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Incident Relations",
              "targetStep": "/api/3/workflow_steps/44072ece-0382-4566-82fb-df09f84e7213",
              "sourceStep": "/api/3/workflow_steps/02d04e17-d3f2-4c9d-820e-f8cb00b69256",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b1bb5a3b-3ad2-49ba-ba2f-4b7ce4558934"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3b9b5b99-67db-4509-857a-582dcc022603",
          "id": 697,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident List",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all incidents from Microsoft Sentinel based on the workspace subscription ID, workspace resource group, workspace name, and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1676386045,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d92d5fbe-6df9-4ab4-8666-aa69ef824ba5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$top": "",
                  "Status": "",
                  "$filter": "",
                  "$orderby": "",
                  "Severity": "",
                  "$skipToken": "",
                  "created_datetime": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident_list",
                "operationTitle": "Get Incident List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "38552fd1-8c64-426b-80ae-40da97dff77d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "386dcc50-e303-4404-b552-db2f46528708",
                "title": "Microsoft Sentinel: Get Incident List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d92d5fbe-6df9-4ab4-8666-aa69ef824ba5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident List",
              "targetStep": "/api/3/workflow_steps/38552fd1-8c64-426b-80ae-40da97dff77d",
              "sourceStep": "/api/3/workflow_steps/d92d5fbe-6df9-4ab4-8666-aa69ef824ba5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "77eb0294-4697-4f2f-aaa2-d3ee88a01b85"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3c603956-4cbf-45d1-83d1-ec05537b68f6",
          "id": 698,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Incident",
          "aliasName": null,
          "tag": null,
          "description": "Updates an incident in Microsoft Sentinel based on the incident ID, Workspace Subscription ID, Workspace Resource Group, workspace name ID, and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672206277,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d78061d1-b5f4-4f17-bceb-f0585fd17bff",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "7e2faa18-aedb-4330-b035-22b0789f5b3c",
                "title": "Microsoft Sentinel: Update Incident",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d78061d1-b5f4-4f17-bceb-f0585fd17bff"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Incident",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "etag": "",
                  "Title": "New Incident",
                  "Status": "Active",
                  "Severity": "Low",
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "Description": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_incident",
                "operationTitle": "Update Incident",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8fe376cf-ca94-45fe-934f-96b8a5d17694"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Incident",
              "targetStep": "/api/3/workflow_steps/8fe376cf-ca94-45fe-934f-96b8a5d17694",
              "sourceStep": "/api/3/workflow_steps/d78061d1-b5f4-4f17-bceb-f0585fd17bff",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "22885c30-2d89-4329-8a78-ba5c939f5abf"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3e2944e6-4fec-4cff-9044-09b29d9aea5f",
          "id": 699,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Threat Intelligence Indicator",
          "aliasName": null,
          "tag": null,
          "description": "Deletes a specific threat intelligence indicator in Microsoft Sentinel based on the threat Intelligence Indicator ID, workspace subscription ID, workspace resource group, workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672205629,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5c2ad680-ea3e-4354-a0dc-6fc407842594",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Threat Intelligence Indicator",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "id": "e16ef847-962e-d7b6-9c8b-a33e4bd30e47"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "delete_threat_intelligence_indicator",
                "operationTitle": "Delete Threat Intelligence Indicator",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8a40fdac-2f03-4c5c-b581-0b6a05c0ad34"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "f046c728-fb4c-40c2-9491-5f2004e5a560",
                "title": "Microsoft Sentinel: Delete Threat Intelligence Indicator",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "5c2ad680-ea3e-4354-a0dc-6fc407842594"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Threat Intelligence Indicator",
              "targetStep": "/api/3/workflow_steps/8a40fdac-2f03-4c5c-b581-0b6a05c0ad34",
              "sourceStep": "/api/3/workflow_steps/5c2ad680-ea3e-4354-a0dc-6fc407842594",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8464a79c-0075-4a93-a401-69bd1e7ee221"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "422da236-ecb8-4b6e-946f-50514a1add02",
          "id": 700,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Incident Bidirectional Sync",
          "aliasName": null,
          "tag": null,
          "description": "Sync incident data with MS Sentinel",
          "isActive": false,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "fortisoar_incident_data"
          ],
          "synchronous": false,
          "lastModifyDate": 1718293790,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b42ddc05-938b-4aae-8b67-da0e61fa9990",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute FortiSOAR Attributes",
              "description": null,
              "arguments": {
                "status": "{{vars.sentinel_status_map.get(vars.input.params.fortisoar_incident_data.status.itemValue)}}",
                "severity": "{{vars.sentinel_severity_map.get(vars.input.params.fortisoar_incident_data.severity.itemValue)}}"
              },
              "status": null,
              "top": "1100",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "0fc241a5-038b-4002-bd5e-e0d8ed5a87ac"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Sentinel Attributes",
              "description": null,
              "arguments": {
                "status": "{{vars.steps.Read_Incidents.data.properties.status | resolveRange(vars.fortioar_status_map)}}",
                "severity": "{{vars.steps.Read_Incidents.data.properties.severity | resolveRange(vars.fortisoar_severity_map)}}"
              },
              "status": null,
              "top": "1100",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "87e80d69-efd2-43fc-b84e-e2a9a1e94f85"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fortioar_status_map": "{'Active': {{'IncidentStatus' | picklist('In Progress') }}, 'Closed': {{'IncidentStatus' | picklist('Resolved') }}, 'New': {{'IncidentStatus'| picklist('Open') }}}",
                "sentinel_status_map": "{\n    \"In Progress\": \"Active\",\n    \"Resolved\": \"Closed\",\n    \"Open\": \"New\",\n    \"Inactive\": \"New\",\n    \"Awaiting\": \"New\"\n}",
                "sentinel_severity_map": "{\n    \"Minimal\": \"Informational\",\n    \"Low\": \"Low\",\n    \"Medium\": \"Medium\",\n    \"High\": \"High\",\n    \"Critical\": \"High\"\n  }",
                "fortisoar_severity_map": "{'Informational': {{'Severity' | picklist('Minimal') }}, 'Low': {{'Severity' | picklist('Low') }}, 'Medium': {{'Severity' | picklist('Medium') }}, 'High': {{'Severity'| picklist('High') }}}",
                "x_minutes_since_last_update": "60",
                "sentinel_incident_classification": "{\n  \"classification\": \"FalsePositive\",\n  \"classificationComment\": \"Not a malicious activity\",\n  \"classificationReason\": \"IncorrectAlertLogic\"\n}"
              },
              "status": null,
              "top": "160",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "673734b0-b6a3-4b0b-9d7a-54b5b9dbeb63"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Sentinel Comments",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Incident_Comments.data.value}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>[Sentinel]: {{vars.steps.Get_Incident_Comments.data.value[0].properties.message}}</p>",
                  "__replace": "true",
                  "incidents": "{{vars.input.params.fortisoar_incident_data[\"@id\"]}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "f4e52ef4-97e1-49fd-8bf1-778c56e75eda"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find New Comments",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "incidents.uuid",
                      "value": "{{vars.input.params.fortisoar_incident_data.uuid}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "datetime",
                      "logic": "AND",
                      "_field": "createDate",
                      "_value": "{{arrow.now().shift(minutes=-(vars.x_minutes_since_last_update + 1)).int_timestamp}}",
                      "filters": [
                        {
                          "type": "datetime",
                          "field": "createDate",
                          "value": "{{getRelativeDate(0,0,0,0,-60,\"end\")}}",
                          "operator": "gt"
                        }
                      ],
                      "_operator": "gt"
                    }
                  ]
                },
                "module": "comments?$limit=30&$relationships=true&$fsr_max_relation_count=10",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "group": null,
              "uuid": "942802e0-8a80-4ca2-8352-312361eaa2b0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Comments",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "$top": 10,
                  "$filter": "createdTimeUtc gt {{arrow.now().shift(minutes=-(vars.x_minutes_since_last_update + 1)).format(\"YYYY-MM-DDTHH:mm:ss\")}}Z",
                  "$orderby": "",
                  "$skipToken": "",
                  "incidentId": "{{vars.input.params.fortisoar_incident_data.sourceId}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_incident_comments",
                "mock_result": "{\n  \"data\": {\n    \"value\": [\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/Comments/8caddded-0e20-48cb-bbd3-9f455a4d030f\",\n        \"etag\": \"\\\"25009470-0000-3200-0000-665edf3a0000\\\"\",\n        \"name\": \"8caddded-0e20-48cb-bbd3-9f455a4d030f\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/Comments\",\n        \"properties\": {\n          \"author\": {\n            \"name\": \"Hany Badawy\",\n            \"email\": \"hany@hbforty.com\",\n            \"objectId\": \"fd5533e3-e598-4cd2-b962-07bd5f3c6b63\",\n            \"userPrincipalName\": \"hany@hbforty.com\"\n          },\n          \"message\": \"<p>A comment from UI</p><p><br></p>\",\n          \"createdTimeUtc\": \"2024-06-04T09:32:42.7323342Z\",\n          \"lastModifiedTimeUtc\": \"2024-06-04T09:32:42.7323342Z\"\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 222 ms\"\n}",
                "operationTitle": "Get All Incident Comments",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "267a47bf-7811-4a3b-bc62-5c9ac4bdbe43"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Last Modification Time",
              "description": null,
              "arguments": {
                "last_sentinel_modification": "{{arrow.get(vars.steps.Read_Incidents.data.properties.lastModifiedTimeUtc).int_timestamp}}",
                "last_fortisoar_modification": "{{vars.input.params.fortisoar_incident_data.modifyDate}}"
              },
              "status": null,
              "top": "840",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "e01995ae-0361-4b35-86f5-1478c8828229"
            },
            {
              "@type": "WorkflowStep",
              "name": "Post FortiSOAR Comments",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "message": "[FortiSOAR]: {{vars.item.content}}",
                  "incidentId": "{{vars.input.params.fortisoar_incident_data.sourceId}}"
                },
                "version": "1.0.0",
                "for_each": {
                  "item": "{{vars.steps.Find_New_Comments}}",
                  "parallel": false,
                  "condition": ""
                },
                "connector": "microsoft-sentinel",
                "operation": "create_incident_comment",
                "operationTitle": "Create Incident Comment",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "307fc377-4380-4d66-989d-c2dde6160ac8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Read Incidents",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "incidentId": "{{vars.input.params.fortisoar_incident_data.sourceId}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident",
                "operationTitle": "Get Incident Details",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "1d41f6c6-fa02-4006-8796-23a4fd81ee5d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b42ddc05-938b-4aae-8b67-da0e61fa9990"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update FortiSOAR Incident",
              "description": null,
              "arguments": {
                "resource": {
                  "status": "{{vars.status}}",
                  "severity": "{{vars.severity}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.params.fortisoar_incident_data[\"@id\"]}}",
                "__recommend": [],
                "collectionType": "/api/3/incidents",
                "fieldOperation": [],
                "step_variables": []
              },
              "status": null,
              "top": "1220",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "eec6b5f6-35fd-4376-a229-7e51ae309c70"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Sentinel Incident",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "etag": "",
                  "Title": "{{vars.steps.Read_Incidents.data.properties.title}}",
                  "Status": "{{vars.status}}",
                  "Severity": "{{vars.severity}}",
                  "incidentId": "{{vars.input.params.fortisoar_incident_data.sourceId}}",
                  "Description": "",
                  "custom_attributes": "{% if vars.status == \"Closed\"%}{{vars.sentinel_incident_classification}}{%endif%}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_incident",
                "operationTitle": "Update Incident",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "1220",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8aa0495b-c93f-4d78-9a8a-db31cc48c97b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Where Last Updated",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Sentinel",
                    "step_iri": "/api/3/workflow_steps/87e80d69-efd2-43fc-b84e-e2a9a1e94f85",
                    "condition": "{{ vars.last_fortisoar_modification < vars.last_sentinel_modification }}",
                    "step_name": "Compute Sentinel Attributes"
                  },
                  {
                    "option": "FortiSOAR",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/0fc241a5-038b-4002-bd5e-e0d8ed5a87ac",
                    "step_name": "Compute FortiSOAR Attributes"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "975",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "a1ff9214-56a1-4e89-8502-4efefec39388"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute FortiSOAR Attributes -> Update Sentinel Incident",
              "targetStep": "/api/3/workflow_steps/8aa0495b-c93f-4d78-9a8a-db31cc48c97b",
              "sourceStep": "/api/3/workflow_steps/0fc241a5-038b-4002-bd5e-e0d8ed5a87ac",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "2891d21e-9c25-48b9-9f04-6da8db1578ff"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Sentinel Attributes -> Update FortiSOAR Incident",
              "targetStep": "/api/3/workflow_steps/eec6b5f6-35fd-4376-a229-7e51ae309c70",
              "sourceStep": "/api/3/workflow_steps/87e80d69-efd2-43fc-b84e-e2a9a1e94f85",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bd8c9154-b4aa-4ee0-98a6-c7f82e27f58f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Read Incidents",
              "targetStep": "/api/3/workflow_steps/1d41f6c6-fa02-4006-8796-23a4fd81ee5d",
              "sourceStep": "/api/3/workflow_steps/673734b0-b6a3-4b0b-9d7a-54b5b9dbeb63",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "057d3c21-f2a9-4f61-adb3-5bd7a80fd162"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Sentinel Comments -> Get Last Modification Time",
              "targetStep": "/api/3/workflow_steps/e01995ae-0361-4b35-86f5-1478c8828229",
              "sourceStep": "/api/3/workflow_steps/f4e52ef4-97e1-49fd-8bf1-778c56e75eda",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "428744e1-5389-40de-9f9c-f510187800c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find New Comments -> Create Sentinel Comments",
              "targetStep": "/api/3/workflow_steps/f4e52ef4-97e1-49fd-8bf1-778c56e75eda",
              "sourceStep": "/api/3/workflow_steps/942802e0-8a80-4ca2-8352-312361eaa2b0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4e733d64-4381-4d8b-9f4d-445fdfb9d13b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find New Comments -> Post FortiSOAR Comments",
              "targetStep": "/api/3/workflow_steps/307fc377-4380-4d66-989d-c2dde6160ac8",
              "sourceStep": "/api/3/workflow_steps/942802e0-8a80-4ca2-8352-312361eaa2b0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7d2de955-2bb3-4793-8064-e2a6274dfba6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Comments -> Find New Comments",
              "targetStep": "/api/3/workflow_steps/942802e0-8a80-4ca2-8352-312361eaa2b0",
              "sourceStep": "/api/3/workflow_steps/267a47bf-7811-4a3b-bc62-5c9ac4bdbe43",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8c3c7612-2239-465e-b65a-d577b94b85f4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Last Modification Time -> Update Ticket",
              "targetStep": "/api/3/workflow_steps/a1ff9214-56a1-4e89-8502-4efefec39388",
              "sourceStep": "/api/3/workflow_steps/e01995ae-0361-4b35-86f5-1478c8828229",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "189bf8f8-b674-489d-9a53-f088ffce436a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Post FortiSOAR Comments -> Get Last Modification Time",
              "targetStep": "/api/3/workflow_steps/e01995ae-0361-4b35-86f5-1478c8828229",
              "sourceStep": "/api/3/workflow_steps/307fc377-4380-4d66-989d-c2dde6160ac8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "64880c31-6efc-4835-b40f-ccfe453ad3e8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Read Incidents -> Get Incident Comments",
              "targetStep": "/api/3/workflow_steps/267a47bf-7811-4a3b-bc62-5c9ac4bdbe43",
              "sourceStep": "/api/3/workflow_steps/1d41f6c6-fa02-4006-8796-23a4fd81ee5d",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "08190333-ad94-4925-9d15-1098289bc829"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/673734b0-b6a3-4b0b-9d7a-54b5b9dbeb63",
              "sourceStep": "/api/3/workflow_steps/b42ddc05-938b-4aae-8b67-da0e61fa9990",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "81ef666d-8fa6-4c39-9484-d91e35bb46bc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Ticket -> Compute FortiSOAR Attributes",
              "targetStep": "/api/3/workflow_steps/0fc241a5-038b-4002-bd5e-e0d8ed5a87ac",
              "sourceStep": "/api/3/workflow_steps/a1ff9214-56a1-4e89-8502-4efefec39388",
              "label": "FortiSOAR",
              "isExecuted": false,
              "group": null,
              "uuid": "2af483ed-96e0-4b6c-b73a-7dfdd122d8f8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Ticket -> Compute Sentinel Attributes",
              "targetStep": "/api/3/workflow_steps/87e80d69-efd2-43fc-b84e-e2a9a1e94f85",
              "sourceStep": "/api/3/workflow_steps/a1ff9214-56a1-4e89-8502-4efefec39388",
              "label": "Sentinel",
              "isExecuted": false,
              "group": null,
              "uuid": "7502f862-732f-4dcf-8e8e-5eca3eb21e1a"
            }
          ],
          "groups": [
            {
              "@type": "WorkflowGroup",
              "name": "Comments Sync",
              "description": "All comments since X min are read and synched between FortiSOAR and Sentinel. Duplicate comments could occur if you run the playbook below the sync period",
              "type": "note",
              "isCollapsed": false,
              "hasTriggerStep": false,
              "hideInLogs": true,
              "metadata": [],
              "reusable": false,
              "top": "580",
              "left": "780",
              "height": "141",
              "width": "340",
              "uuid": "af6eaa70-9f76-4298-9983-f525d7fd5c56",
              "recordTags": []
            },
            {
              "@type": "WorkflowGroup",
              "name": "Update Status and Severity",
              "description": "if status and/or severity change on either FortiSOAR or MS Sentinel them most recent change will be replicated to the instance with the older values",
              "type": "note",
              "isCollapsed": false,
              "hasTriggerStep": false,
              "hideInLogs": true,
              "metadata": [],
              "reusable": false,
              "top": "980",
              "left": "800",
              "height": "136",
              "width": "336",
              "uuid": "f87459df-cb92-4802-85dc-27fea00b7a2c",
              "recordTags": []
            },
            {
              "@type": "WorkflowGroup",
              "name": "x_minutes_since_last_update param",
              "description": "determines the update frequency, the playbook scheduler should have the same value",
              "type": "note",
              "isCollapsed": false,
              "hasTriggerStep": false,
              "hideInLogs": true,
              "metadata": [],
              "reusable": false,
              "top": "160",
              "left": "580",
              "height": "102",
              "width": "342",
              "uuid": "66db21ad-4137-4ef3-b38e-e5c4c14586d6",
              "recordTags": []
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "575a1d8b-76b4-432c-9712-fc3b31f9dcbf",
          "id": 765,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel",
            "UseCase"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Threat Intelligence Indicator",
          "aliasName": null,
          "tag": null,
          "description": "Creates a threat intelligence indicator in Microsoft Sentinel based on the workspace subscription ID, workspace resource group, workspace name, and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1677047082,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/df64d5cd-05cd-4498-8a28-0370b5fc7db2",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Threat Intelligence Indicator",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "labels": "",
                  "source": "Microsoft Sentinel",
                  "pattern": "1.1.1.1",
                  "confidence": 10,
                  "description": "",
                  "displayName": "New Indicator",
                  "patternType": "IPV4 Address",
                  "threatTypes": "",
                  "indicatorTypes": "",
                  "additional_fields": "",
                  "threatIntelligenceTags": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "create_threat_intelligence_indicator",
                "operationTitle": "Create Threat Intelligence Indicator",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a2f7d064-068a-463d-891b-d99d6c234b16"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "dbf7822f-6212-48ac-bf6c-f3a3063ce10c",
                "title": "Microsoft Sentinel: Create Threat Intelligence Indicator",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "df64d5cd-05cd-4498-8a28-0370b5fc7db2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Threat Intelligence Indicator",
              "targetStep": "/api/3/workflow_steps/a2f7d064-068a-463d-891b-d99d6c234b16",
              "sourceStep": "/api/3/workflow_steps/df64d5cd-05cd-4498-8a28-0370b5fc7db2",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "28f6d8bc-6d43-4586-b83e-9e061e503c8f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "5bf4eeeb-b76a-491b-8ad7-a206829c4fa6",
          "id": 701,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Alert List",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all alerts associated with a specific incident from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace resource group, workspace name ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672205993,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f7fa59fd-881f-4ac7-b90b-dee778c45c1c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Alert List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_alert_list",
                "operationTitle": "Get Incident Alert List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "edc66969-16e6-4b75-8917-a0d89e8da662"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "50d866d3-88aa-4d8b-b36b-0ae26dc570de",
                "title": "Microsoft Sentinel: Get Incident Alert List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "f7fa59fd-881f-4ac7-b90b-dee778c45c1c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Alert List",
              "targetStep": "/api/3/workflow_steps/edc66969-16e6-4b75-8917-a0d89e8da662",
              "sourceStep": "/api/3/workflow_steps/f7fa59fd-881f-4ac7-b90b-dee778c45c1c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8a6681a9-d1c1-4d48-9d57-1d0fa9689b13"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "5ef2c493-fc19-4485-997a-3d421e76b1f6",
          "id": 702,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Relation",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a specific relation of a incident from Microsoft Sentinel based on the incident ID, relation name, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672206825,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/3f7ef624-f9b8-4537-8903-c6f6c9292225",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Relation",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "relationName": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident_relations",
                "operationTitle": "Get Incident Relation",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "187938d5-3ccd-4ccb-924a-07177b13de61"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "2e8605c4-4b89-4744-9f68-fbf01a457839",
                "title": "Microsoft Sentinel: Get Incident Relation",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "3f7ef624-f9b8-4537-8903-c6f6c9292225"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Relation",
              "targetStep": "/api/3/workflow_steps/187938d5-3ccd-4ccb-924a-07177b13de61",
              "sourceStep": "/api/3/workflow_steps/3f7ef624-f9b8-4537-8903-c6f6c9292225",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d3cae834-90cb-4453-a407-6bb51c850c68"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "6f68b530-8200-49f5-ba6a-cf5cbba523ab",
          "id": 703,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get All Incident Comments",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all incident comments from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace resource group, workspace name, and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207436,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6f48da8d-2bc1-4b8b-84b7-4de4b58363b4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Incident Comments",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$top": "",
                  "$filter": "",
                  "$orderby": "",
                  "$skipToken": "",
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_incident_comments",
                "operationTitle": "Get All Incident Comments",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ac12de3b-94c5-499f-b534-a4dfcba26d25"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6e81ade7-2185-4ac2-a444-f457b92e3bc8",
                "title": "Microsoft Sentinel: Get All Incident Comments",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6f48da8d-2bc1-4b8b-84b7-4de4b58363b4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Incident Comments",
              "targetStep": "/api/3/workflow_steps/ac12de3b-94c5-499f-b534-a4dfcba26d25",
              "sourceStep": "/api/3/workflow_steps/6f48da8d-2bc1-4b8b-84b7-4de4b58363b4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9697a1ce-2a08-46da-9ac3-be99779988ff"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "70264404-fe02-4398-b083-e0a2862c5892",
          "id": 704,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Incident Comment",
          "aliasName": null,
          "tag": null,
          "description": "Updates an incident comment in Microsoft Sentinel based on the incident comment ID, incident ID, message, workspace subscription ID, workspace resource group, and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207691,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b496d7b4-f768-4aea-80fd-7d9ea2d1f4a5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4dca251d-e1db-4c48-ac83-28c3b2fcdad2",
                "title": "Microsoft Sentinel: Update Incident Comment",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b496d7b4-f768-4aea-80fd-7d9ea2d1f4a5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Incident Comment",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "message": "Also, please provide bookmark id.",
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "incidentcommentId": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_incident_comment",
                "operationTitle": "Update Incident Comment",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "53c2966e-6ddd-4a7b-9744-c71ef9039899"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Incident Comment",
              "targetStep": "/api/3/workflow_steps/53c2966e-6ddd-4a7b-9744-c71ef9039899",
              "sourceStep": "/api/3/workflow_steps/b496d7b4-f768-4aea-80fd-7d9ea2d1f4a5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c431675a-9857-41c5-b276-33c623620512"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "72d5fda3-8778-4044-96b5-7d4148ec6456",
          "id": 705,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Watchlist",
          "aliasName": null,
          "tag": null,
          "description": "Creates a watchlist in Microsoft Sentinel based on the display name, item search key, provider, source, workspace subscription ID, workspace resource group, workspace name and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672638400,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/78fac159-a29e-481e-919d-9eae6718d684",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Watchlist",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "etag": "",
                  "source": "Microsoft",
                  "provider": "Local file",
                  "description": "",
                  "displayName": "High Value Assets Watchlist",
                  "itemsSearchKey": "Header",
                  "custom_attributes": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "create_watchlist",
                "operationTitle": "Create Watchlist",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a1c3bbf3-3cdb-4fb6-94db-14afd109fef0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "f425c4d0-034d-4cd6-8823-2ae2bf1d30d4",
                "title": "Microsoft Sentinel: Create Watchlist",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "78fac159-a29e-481e-919d-9eae6718d684"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Watchlist",
              "targetStep": "/api/3/workflow_steps/a1c3bbf3-3cdb-4fb6-94db-14afd109fef0",
              "sourceStep": "/api/3/workflow_steps/78fac159-a29e-481e-919d-9eae6718d684",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "48ba2281-6df1-44d3-9f34-f23d6dd93d58"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "7b40607b-6269-4b46-9a74-2d5ee69a81f3",
          "id": 707,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Watchlist Item",
          "aliasName": null,
          "tag": null,
          "description": "Creates a watchlist item in Microsoft Sentinel based on the watchlist alias, item key value, workspace subscription ID, workspace resource group, workspace name and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672638933,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9d4e6476-c290-426b-bea6-6102bd04b637",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Watchlist Item",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "etag": "",
                  "itemsKeyValue": "{\n  \"Gateway subnet\": \"10.0.255.224/27\",\n  \"Web Tier\": \"10.0.1.0/24\",\n  \"Business tier\": \"10.0.2.0/24\",\n  \"Data tier\": \"10.0.2.0/24\",\n  \"Private DMZ in\": \"10.0.0.0/27\",\n  \"Public DMZ out\": \"10.0.0.96/27\"\n}",
                  "watchlistAlias": "highValueAsset",
                  "custom_attributes": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "create_watchlist_item",
                "operationTitle": "Create Watchlist Item",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bfa20b68-727b-4e5a-b296-e04bd6520e7a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ab11b4e3-09d8-41d1-bb1f-e7ac65c1ebce",
                "title": "Microsoft Sentinel: Create Watchlist Item",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "9d4e6476-c290-426b-bea6-6102bd04b637"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Watchlist Item",
              "targetStep": "/api/3/workflow_steps/bfa20b68-727b-4e5a-b296-e04bd6520e7a",
              "sourceStep": "/api/3/workflow_steps/9d4e6476-c290-426b-bea6-6102bd04b637",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a127e111-300d-4dd8-935d-9f20655a9fca"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "7cdb076a-3891-4c3d-8442-831401d9bcc5",
          "id": 708,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Incident Relation",
          "aliasName": null,
          "tag": null,
          "description": "Deletes a specific incident relation in Microsoft Sentinel based on the incident ID, relation name, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207220,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fd1c4c9d-f1b2-42e1-9738-d130a4691503",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Incident Relation",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "relationName": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "delete_incident_relation",
                "operationTitle": "Delete Incident Relation",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "cb459df8-6456-4ea0-a1f5-76e9ffdcb0c9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "dd31ebdc-5dcf-4b70-9f73-c3638fef27db",
                "title": "Microsoft Sentinel: Delete Incident Relation",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "fd1c4c9d-f1b2-42e1-9738-d130a4691503"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Incident Relation",
              "targetStep": "/api/3/workflow_steps/cb459df8-6456-4ea0-a1f5-76e9ffdcb0c9",
              "sourceStep": "/api/3/workflow_steps/fd1c4c9d-f1b2-42e1-9738-d130a4691503",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1f36e903-9ab1-425d-b8c9-1282fa1b5f22"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "8195a3ca-f6dc-4ea0-a6ea-c97b4684c5b6",
          "id": 709,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Get Alert Related Events",
          "aliasName": null,
          "tag": null,
          "description": "Get events for each related alert",
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "alert"
          ],
          "synchronous": false,
          "lastModifyDate": 1717754211,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f4d90847-36a3-4173-a793-35a00547d851",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Build Queries Query",
              "description": null,
              "arguments": {
                "get_queries_query": "SecurityAlert | where SystemAlertId in ('{{vars.input.params.alert.name}}') | project query = tostring(parse_json(ExtendedProperties).[\"Query\"])"
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b772bf50-f8cc-4037-970a-dd2cb71adf40"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "events": "[]",
                "max_records": "10"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "843b2b82-7b95-436b-80cc-808994ecd3a8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Indicators",
              "description": null,
              "arguments": {
                "when": "{{vars.rows | length > 0}}",
                "params": {
                  "data": "{{vars.rows|unique|join(' ')}}",
                  "whitelist": "",
                  "case_sensitive": false,
                  "override_regex": false,
                  "private_whitelist": true
                },
                "version": "3.3.0",
                "connector": "cyops_utilities",
                "operation": "extract_artifacts",
                "operationTitle": "FSR: Extract Artifacts from String",
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "5701eff2-9213-4f41-8d1d-207419a0c738"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alert Queries",
              "description": null,
              "arguments": {
                "name": "Azure Log Analytics",
                "config": "313c6144-14b2-4df9-b7cf-5526bf77d13f",
                "params": {
                  "query": "{{vars.get_queries_query}}",
                  "timespan": "",
                  "workspaces": "",
                  "WorkspaceId": "6c3970b0-0d7b-4e81-bb05-25e1c2cfdc2e"
                },
                "version": "2.0.0",
                "connector": "azure-log-analytics",
                "operation": "execute_query",
                "mock_result": "{\n  \"data\": {\n    \"tables\": [\n      {\n        \"name\": \"PrimaryResult\",\n        \"rows\": [\n          [\n            \"38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n            \"// The query_now parameter represents the time (in UTC) at which the scheduled analytics rule ran to produce this alert.\\nset query_now = datetime(2024-05-27T16:59:45.2313171Z);\\nlet domains = dynamic([\\\"incomeupdate.com\\\",\\\"zupertech.com\\\",\\\"databasegalore.com\\\",\\\"panhardware.com\\\",\\\"avsvmcloud.com\\\",\\\"digitalcollege.org\\\",\\\"freescanonline.com\\\",\\\"deftsecurity.com\\\",\\\"thedoccloud.com\\\",\\\"virtualdataserver.com\\\",\\\"lcomputers.com\\\",\\\"webcodez.com\\\",\\\"globalnetworkissues.com\\\",\\\"kubecloud.com\\\",\\\"seobundlekit.com\\\",\\\"solartrackingsystem.net\\\",\\\"virtualwebdata.com\\\"]);\\n(union isfuzzy=true\\n(CommonSecurityLog \\n  | parse Message with * '(' DNSName ')' * \\n  | where DNSName in~ (domains) or DestinationHostName has_any (domains) or RequestURL has_any(domains)\\n  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP\\n  ),\\n(DnsEvents \\n  | extend DNSName = Name\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = ClientIP\\n  ),\\n(imDns \\n  | where isnotempty(Query)\\n  | where Query in~ (domains)\\n  | extend DNSName = Query\\n  | extend IPCustomEntity = SrcIpAddr\\n  ),\\n(VMConnection \\n  | parse RemoteDnsCanonicalNames with * '[\\\"' DNSName '\\\"]' *\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = RemoteIp\\n  ),\\n(DeviceNetworkEvents \\n  | where isnotempty(RemoteUrl) \\n  | where RemoteUrl  has_any (domains)  \\n  | extend DNSName = RemoteUrl\\n  | extend IPCustomEntity = RemoteIP \\n  | extend HostCustomEntity = DeviceName \\n  ),\\n(AzureDiagnostics\\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallDnsProxy\\\"\\n  | parse msg_s with \\\"DNS Request: \\\" ClientIP \\\":\\\" ClientPort \\\" - \\\" QueryID \\\" \\\" Request_Type \\\" \\\" Request_Class \\\" \\\" Request_Name \\\". \\\" Request_Protocol \\\" \\\" Request_Size \\\" \\\" EDNSO_DO \\\" \\\" EDNS0_Buffersize \\\" \\\" Responce_Code \\\" \\\" Responce_Flags \\\" \\\" Responce_Size \\\" \\\" Response_Duration\\n  | where Request_Name has_any (domains)  \\n  | extend DNSName = Request_Name\\n  | extend IPCustomEntity = ClientIP \\n  ),\\n(AzureDiagnostics \\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallApplicationRule\\\"\\n  | parse msg_s with Protocol 'request from ' SourceHost ':' SourcePort 'to ' DestinationHost ':' DestinationPort '. Action:' Action\\n  | where isnotempty(DestinationHost)\\n  | where DestinationHost has_any (domains)  \\n  | extend DNSName = DestinationHost \\n  | extend IPCustomEntity = SourceHost\\n  ) \\n  )\"\n          ],\n          [\n            \"8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n            \"// The query_now parameter represents the time (in UTC) at which the scheduled analytics rule ran to produce this alert.\\nset query_now = datetime(2024-05-27T17:04:45.2313171Z);\\nlet domains = dynamic([\\\"incomeupdate.com\\\",\\\"zupertech.com\\\",\\\"databasegalore.com\\\",\\\"panhardware.com\\\",\\\"avsvmcloud.com\\\",\\\"digitalcollege.org\\\",\\\"freescanonline.com\\\",\\\"deftsecurity.com\\\",\\\"thedoccloud.com\\\",\\\"virtualdataserver.com\\\",\\\"lcomputers.com\\\",\\\"webcodez.com\\\",\\\"globalnetworkissues.com\\\",\\\"kubecloud.com\\\",\\\"seobundlekit.com\\\",\\\"solartrackingsystem.net\\\",\\\"virtualwebdata.com\\\"]);\\n(union isfuzzy=true\\n(CommonSecurityLog \\n  | parse Message with * '(' DNSName ')' * \\n  | where DNSName in~ (domains) or DestinationHostName has_any (domains) or RequestURL has_any(domains)\\n  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP\\n  ),\\n(DnsEvents \\n  | extend DNSName = Name\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = ClientIP\\n  ),\\n(imDns \\n  | where isnotempty(Query)\\n  | where Query in~ (domains)\\n  | extend DNSName = Query\\n  | extend IPCustomEntity = SrcIpAddr\\n  ),\\n(VMConnection \\n  | parse RemoteDnsCanonicalNames with * '[\\\"' DNSName '\\\"]' *\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = RemoteIp\\n  ),\\n(DeviceNetworkEvents \\n  | where isnotempty(RemoteUrl) \\n  | where RemoteUrl  has_any (domains)  \\n  | extend DNSName = RemoteUrl\\n  | extend IPCustomEntity = RemoteIP \\n  | extend HostCustomEntity = DeviceName \\n  ),\\n(AzureDiagnostics\\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallDnsProxy\\\"\\n  | parse msg_s with \\\"DNS Request: \\\" ClientIP \\\":\\\" ClientPort \\\" - \\\" QueryID \\\" \\\" Request_Type \\\" \\\" Request_Class \\\" \\\" Request_Name \\\". \\\" Request_Protocol \\\" \\\" Request_Size \\\" \\\" EDNSO_DO \\\" \\\" EDNS0_Buffersize \\\" \\\" Responce_Code \\\" \\\" Responce_Flags \\\" \\\" Responce_Size \\\" \\\" Response_Duration\\n  | where Request_Name has_any (domains)  \\n  | extend DNSName = Request_Name\\n  | extend IPCustomEntity = ClientIP \\n  ),\\n(AzureDiagnostics \\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallApplicationRule\\\"\\n  | parse msg_s with Protocol 'request from ' SourceHost ':' SourcePort 'to ' DestinationHost ':' DestinationPort '. Action:' Action\\n  | where isnotempty(DestinationHost)\\n  | where DestinationHost has_any (domains)  \\n  | extend DNSName = DestinationHost \\n  | extend IPCustomEntity = SourceHost\\n  ) \\n  )\"\n          ],\n          [\n            \"a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n            \"// The query_now parameter represents the time (in UTC) at which the scheduled analytics rule ran to produce this alert.\\nset query_now = datetime(2024-05-27T17:09:45.2313171Z);\\nlet domains = dynamic([\\\"incomeupdate.com\\\",\\\"zupertech.com\\\",\\\"databasegalore.com\\\",\\\"panhardware.com\\\",\\\"avsvmcloud.com\\\",\\\"digitalcollege.org\\\",\\\"freescanonline.com\\\",\\\"deftsecurity.com\\\",\\\"thedoccloud.com\\\",\\\"virtualdataserver.com\\\",\\\"lcomputers.com\\\",\\\"webcodez.com\\\",\\\"globalnetworkissues.com\\\",\\\"kubecloud.com\\\",\\\"seobundlekit.com\\\",\\\"solartrackingsystem.net\\\",\\\"virtualwebdata.com\\\"]);\\n(union isfuzzy=true\\n(CommonSecurityLog \\n  | parse Message with * '(' DNSName ')' * \\n  | where DNSName in~ (domains) or DestinationHostName has_any (domains) or RequestURL has_any(domains)\\n  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP\\n  ),\\n(DnsEvents \\n  | extend DNSName = Name\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = ClientIP\\n  ),\\n(imDns \\n  | where isnotempty(Query)\\n  | where Query in~ (domains)\\n  | extend DNSName = Query\\n  | extend IPCustomEntity = SrcIpAddr\\n  ),\\n(VMConnection \\n  | parse RemoteDnsCanonicalNames with * '[\\\"' DNSName '\\\"]' *\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = RemoteIp\\n  ),\\n(DeviceNetworkEvents \\n  | where isnotempty(RemoteUrl) \\n  | where RemoteUrl  has_any (domains)  \\n  | extend DNSName = RemoteUrl\\n  | extend IPCustomEntity = RemoteIP \\n  | extend HostCustomEntity = DeviceName \\n  ),\\n(AzureDiagnostics\\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallDnsProxy\\\"\\n  | parse msg_s with \\\"DNS Request: \\\" ClientIP \\\":\\\" ClientPort \\\" - \\\" QueryID \\\" \\\" Request_Type \\\" \\\" Request_Class \\\" \\\" Request_Name \\\". \\\" Request_Protocol \\\" \\\" Request_Size \\\" \\\" EDNSO_DO \\\" \\\" EDNS0_Buffersize \\\" \\\" Responce_Code \\\" \\\" Responce_Flags \\\" \\\" Responce_Size \\\" \\\" Response_Duration\\n  | where Request_Name has_any (domains)  \\n  | extend DNSName = Request_Name\\n  | extend IPCustomEntity = ClientIP \\n  ),\\n(AzureDiagnostics \\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallApplicationRule\\\"\\n  | parse msg_s with Protocol 'request from ' SourceHost ':' SourcePort 'to ' DestinationHost ':' DestinationPort '. Action:' Action\\n  | where isnotempty(DestinationHost)\\n  | where DestinationHost has_any (domains)  \\n  | extend DNSName = DestinationHost \\n  | extend IPCustomEntity = SourceHost\\n  ) \\n  )\"\n          ],\n          [\n            \"11d64be3-399e-da8d-6246-88c493fb2303\",\n            \"// The query_now parameter represents the time (in UTC) at which the scheduled analytics rule ran to produce this alert.\\nset query_now = datetime(2024-05-27T17:14:45.2313171Z);\\nlet domains = dynamic([\\\"incomeupdate.com\\\",\\\"zupertech.com\\\",\\\"databasegalore.com\\\",\\\"panhardware.com\\\",\\\"avsvmcloud.com\\\",\\\"digitalcollege.org\\\",\\\"freescanonline.com\\\",\\\"deftsecurity.com\\\",\\\"thedoccloud.com\\\",\\\"virtualdataserver.com\\\",\\\"lcomputers.com\\\",\\\"webcodez.com\\\",\\\"globalnetworkissues.com\\\",\\\"kubecloud.com\\\",\\\"seobundlekit.com\\\",\\\"solartrackingsystem.net\\\",\\\"virtualwebdata.com\\\"]);\\n(union isfuzzy=true\\n(CommonSecurityLog \\n  | parse Message with * '(' DNSName ')' * \\n  | where DNSName in~ (domains) or DestinationHostName has_any (domains) or RequestURL has_any(domains)\\n  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP\\n  ),\\n(DnsEvents \\n  | extend DNSName = Name\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = ClientIP\\n  ),\\n(imDns \\n  | where isnotempty(Query)\\n  | where Query in~ (domains)\\n  | extend DNSName = Query\\n  | extend IPCustomEntity = SrcIpAddr\\n  ),\\n(VMConnection \\n  | parse RemoteDnsCanonicalNames with * '[\\\"' DNSName '\\\"]' *\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = RemoteIp\\n  ),\\n(DeviceNetworkEvents \\n  | where isnotempty(RemoteUrl) \\n  | where RemoteUrl  has_any (domains)  \\n  | extend DNSName = RemoteUrl\\n  | extend IPCustomEntity = RemoteIP \\n  | extend HostCustomEntity = DeviceName \\n  ),\\n(AzureDiagnostics\\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallDnsProxy\\\"\\n  | parse msg_s with \\\"DNS Request: \\\" ClientIP \\\":\\\" ClientPort \\\" - \\\" QueryID \\\" \\\" Request_Type \\\" \\\" Request_Class \\\" \\\" Request_Name \\\". \\\" Request_Protocol \\\" \\\" Request_Size \\\" \\\" EDNSO_DO \\\" \\\" EDNS0_Buffersize \\\" \\\" Responce_Code \\\" \\\" Responce_Flags \\\" \\\" Responce_Size \\\" \\\" Response_Duration\\n  | where Request_Name has_any (domains)  \\n  | extend DNSName = Request_Name\\n  | extend IPCustomEntity = ClientIP \\n  ),\\n(AzureDiagnostics \\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallApplicationRule\\\"\\n  | parse msg_s with Protocol 'request from ' SourceHost ':' SourcePort 'to ' DestinationHost ':' DestinationPort '. Action:' Action\\n  | where isnotempty(DestinationHost)\\n  | where DestinationHost has_any (domains)  \\n  | extend DNSName = DestinationHost \\n  | extend IPCustomEntity = SourceHost\\n  ) \\n  )\"\n          ],\n          [\n            \"c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n            \"// The query_now parameter represents the time (in UTC) at which the scheduled analytics rule ran to produce this alert.\\nset query_now = datetime(2024-05-27T17:19:45.2313171Z);\\nlet domains = dynamic([\\\"incomeupdate.com\\\",\\\"zupertech.com\\\",\\\"databasegalore.com\\\",\\\"panhardware.com\\\",\\\"avsvmcloud.com\\\",\\\"digitalcollege.org\\\",\\\"freescanonline.com\\\",\\\"deftsecurity.com\\\",\\\"thedoccloud.com\\\",\\\"virtualdataserver.com\\\",\\\"lcomputers.com\\\",\\\"webcodez.com\\\",\\\"globalnetworkissues.com\\\",\\\"kubecloud.com\\\",\\\"seobundlekit.com\\\",\\\"solartrackingsystem.net\\\",\\\"virtualwebdata.com\\\"]);\\n(union isfuzzy=true\\n(CommonSecurityLog \\n  | parse Message with * '(' DNSName ')' * \\n  | where DNSName in~ (domains) or DestinationHostName has_any (domains) or RequestURL has_any(domains)\\n  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP\\n  ),\\n(DnsEvents \\n  | extend DNSName = Name\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = ClientIP\\n  ),\\n(imDns \\n  | where isnotempty(Query)\\n  | where Query in~ (domains)\\n  | extend DNSName = Query\\n  | extend IPCustomEntity = SrcIpAddr\\n  ),\\n(VMConnection \\n  | parse RemoteDnsCanonicalNames with * '[\\\"' DNSName '\\\"]' *\\n  | where isnotempty(DNSName)\\n  | where DNSName in~ (domains)\\n  | extend IPCustomEntity = RemoteIp\\n  ),\\n(DeviceNetworkEvents \\n  | where isnotempty(RemoteUrl) \\n  | where RemoteUrl  has_any (domains)  \\n  | extend DNSName = RemoteUrl\\n  | extend IPCustomEntity = RemoteIP \\n  | extend HostCustomEntity = DeviceName \\n  ),\\n(AzureDiagnostics\\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallDnsProxy\\\"\\n  | parse msg_s with \\\"DNS Request: \\\" ClientIP \\\":\\\" ClientPort \\\" - \\\" QueryID \\\" \\\" Request_Type \\\" \\\" Request_Class \\\" \\\" Request_Name \\\". \\\" Request_Protocol \\\" \\\" Request_Size \\\" \\\" EDNSO_DO \\\" \\\" EDNS0_Buffersize \\\" \\\" Responce_Code \\\" \\\" Responce_Flags \\\" \\\" Responce_Size \\\" \\\" Response_Duration\\n  | where Request_Name has_any (domains)  \\n  | extend DNSName = Request_Name\\n  | extend IPCustomEntity = ClientIP \\n  ),\\n(AzureDiagnostics \\n  | where ResourceType == \\\"AZUREFIREWALLS\\\"\\n  | where Category == \\\"AzureFirewallApplicationRule\\\"\\n  | parse msg_s with Protocol 'request from ' SourceHost ':' SourcePort 'to ' DestinationHost ':' DestinationPort '. Action:' Action\\n  | where isnotempty(DestinationHost)\\n  | where DestinationHost has_any (domains)  \\n  | extend DNSName = DestinationHost \\n  | extend IPCustomEntity = SourceHost\\n  ) \\n  )\"\n          ]\n        ],\n        \"columns\": [\n          {\n            \"name\": \"SystemAlertId\",\n            \"type\": \"string\"\n          },\n          {\n            \"name\": \"query\",\n            \"type\": \"string\"\n          }\n        ]\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"3 seconds 538 ms\"\n}",
                "ignore_errors": true,
                "operationTitle": "Execute Query",
                "pickFromTenant": false,
                "step_variables": {
                  "query_result": "{{vars.steps.Get_Alert_Queries.data.tables ~ \"take vars.max_records\"}}"
                }
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f28167e7-f3e0-4eb1-8593-3eb4dbd24a68"
            },
            {
              "@type": "WorkflowStep",
              "name": "Merge Alert Data",
              "description": null,
              "arguments": {
                "_update_alert": "{{vars.input.params.alert.update({\"events\":vars.events})}}"
              },
              "status": null,
              "top": "1100",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "19cbb60c-34f3-4ae5-ac10-a3ff4bf69e3f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Output",
              "description": null,
              "arguments": {
                "alert": "{{vars.input.params.alert}}",
                "indicators": "{{vars.unified_iocs}}"
              },
              "status": null,
              "top": "1245",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "77036bbd-9a91-4971-afef-71748d9d3fc2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Parse Queries",
              "description": null,
              "arguments": {
                "rows": "{{vars.tables|json_query(\"[].rows[][]\")}}",
                "_parse_query": "{%for event in vars.tables%}\n{%set _event={}%}\n{%for field in event.columns%}\n{%set _value = event.rows.0[loop.index-1]%}\n{%if _value is not none and _value != \"\"%}\n{{_event.update({field.name:_value})}}\n{%endif%}\n{%endfor%}\n{{vars.events.append(_event)}}\n{%endfor%}"
              },
              "status": null,
              "top": "705",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ffb8b368-f800-49e8-b08d-b258d40e5dda"
            },
            {
              "@type": "WorkflowStep",
              "name": "Remove Picklist IRIs",
              "description": null,
              "arguments": {
                "_iri_remove": "{%for entry in vars.unified_iocs%}\n{{entry.pop(\"picklist_iri\")}}\n{%endfor%}"
              },
              "status": null,
              "top": "1100",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "accd862e-0720-4207-a7b0-101d133a5e13"
            },
            {
              "@type": "WorkflowStep",
              "name": "Removing NULL Indicators",
              "description": "Removing null indicators extracted from email",
              "arguments": {
                "unified_iocs": "{{vars.steps.Extract_Indicators.data.results | json_query('[?value != null]') | unique}}"
              },
              "status": null,
              "top": "960",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b8212e00-4661-4d53-8d4e-e915523ee76f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Run Fetch Event Query",
              "description": null,
              "arguments": {
                "name": "Azure Log Analytics",
                "when": "{{vars.steps.Get_Alert_Queries.data.tables[0].rows[0].0 | length > 0}}",
                "config": "313c6144-14b2-4df9-b7cf-5526bf77d13f",
                "params": {
                  "query": "{{vars.steps.Get_Alert_Queries.data.tables[0].rows[0].0}}",
                  "timespan": "",
                  "workspaces": "",
                  "WorkspaceId": "6c3970b0-0d7b-4e81-bb05-25e1c2cfdc2e"
                },
                "version": "2.0.0",
                "connector": "azure-log-analytics",
                "operation": "execute_query",
                "ignore_errors": true,
                "operationTitle": "Execute Query",
                "pickFromTenant": false,
                "step_variables": {
                  "tables": "{{vars.steps.Run_Fetch_Event_Query.data.tables}}"
                }
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "241ed6dd-70e6-42ba-915f-b6ae20bf5584"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "f4d90847-36a3-4173-a793-35a00547d851"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Build Queries Query -> Get Alert Queries",
              "targetStep": "/api/3/workflow_steps/f28167e7-f3e0-4eb1-8593-3eb4dbd24a68",
              "sourceStep": "/api/3/workflow_steps/b772bf50-f8cc-4037-970a-dd2cb71adf40",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f0f539bf-f782-4222-bcba-cca3b5a689da"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Build Queries Query",
              "targetStep": "/api/3/workflow_steps/b772bf50-f8cc-4037-970a-dd2cb71adf40",
              "sourceStep": "/api/3/workflow_steps/843b2b82-7b95-436b-80cc-808994ecd3a8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5a2303ce-77f2-4c80-80fe-504ea3c48e9c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Indicators -> Removing NULL Indicators",
              "targetStep": "/api/3/workflow_steps/b8212e00-4661-4d53-8d4e-e915523ee76f",
              "sourceStep": "/api/3/workflow_steps/5701eff2-9213-4f41-8d1d-207419a0c738",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9e046d8d-c625-4a12-b875-8203c490bf73"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alert Queries -> Run Fetch Event Query",
              "targetStep": "/api/3/workflow_steps/241ed6dd-70e6-42ba-915f-b6ae20bf5584",
              "sourceStep": "/api/3/workflow_steps/f28167e7-f3e0-4eb1-8593-3eb4dbd24a68",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a9797067-c881-4bad-8196-99eb258308d5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Merge Alert Data -> Output",
              "targetStep": "/api/3/workflow_steps/77036bbd-9a91-4971-afef-71748d9d3fc2",
              "sourceStep": "/api/3/workflow_steps/19cbb60c-34f3-4ae5-ac10-a3ff4bf69e3f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "263e52f9-4989-40c4-946f-65f719aff7be"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Parse Queries -> Extract Indicators",
              "targetStep": "/api/3/workflow_steps/5701eff2-9213-4f41-8d1d-207419a0c738",
              "sourceStep": "/api/3/workflow_steps/ffb8b368-f800-49e8-b08d-b258d40e5dda",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8fb260aa-5b05-4eeb-990d-97cc1992f42b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Parse Queries -> Output",
              "targetStep": "/api/3/workflow_steps/19cbb60c-34f3-4ae5-ac10-a3ff4bf69e3f",
              "sourceStep": "/api/3/workflow_steps/ffb8b368-f800-49e8-b08d-b258d40e5dda",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f97ada66-765a-441c-a657-b7c9c0e082b5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Remove Picklist IRIs -> Output",
              "targetStep": "/api/3/workflow_steps/77036bbd-9a91-4971-afef-71748d9d3fc2",
              "sourceStep": "/api/3/workflow_steps/accd862e-0720-4207-a7b0-101d133a5e13",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b25ec58a-c60b-46fa-b059-e6885af41a5f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Removing NULL Indicators -> Copy of Removing NULL Indicators",
              "targetStep": "/api/3/workflow_steps/accd862e-0720-4207-a7b0-101d133a5e13",
              "sourceStep": "/api/3/workflow_steps/b8212e00-4661-4d53-8d4e-e915523ee76f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "961ddb2f-c015-45b2-b2ef-50447155bf7d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Run Fetch Event Query -> Parse Queries",
              "targetStep": "/api/3/workflow_steps/ffb8b368-f800-49e8-b08d-b258d40e5dda",
              "sourceStep": "/api/3/workflow_steps/241ed6dd-70e6-42ba-915f-b6ae20bf5584",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "08652618-f508-4c9b-841a-6fe1252b42e9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/843b2b82-7b95-436b-80cc-808994ecd3a8",
              "sourceStep": "/api/3/workflow_steps/f4d90847-36a3-4173-a793-35a00547d851",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "85ecd4a3-d04b-46c8-ae0e-ce3ca93887a1"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "8fe7c198-96a0-4a8b-b0ea-88e13c44cc59",
          "id": 742,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Incident Comment",
          "aliasName": null,
          "tag": null,
          "description": "Creates a incident comment in Microsoft Sentinel based on the incident ID, message, workspace subscription ID, workspace resource group, and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207342,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/733dd832-78ac-4554-8507-50c57680faaa",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Incident Comment",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "message": "Please provide entity id.",
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "create_incident_comment",
                "operationTitle": "Create Incident Comment",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f9d4836b-a01c-4056-bf39-b69d2983755f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "cbd59a89-1e12-4f2c-b740-c5f9b24c6d8c",
                "title": "Microsoft Sentinel: Create Incident Comment",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "733dd832-78ac-4554-8507-50c57680faaa"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Incident Comment",
              "targetStep": "/api/3/workflow_steps/f9d4836b-a01c-4056-bf39-b69d2983755f",
              "sourceStep": "/api/3/workflow_steps/733dd832-78ac-4554-8507-50c57680faaa",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "72b965da-2850-45c1-8076-1f3b35a2ade0"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9084d9e0-4e29-474d-a013-f5a321b68f28",
          "id": 710,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Watchlist",
          "aliasName": null,
          "tag": null,
          "description": "Updates an watchlist in Microsoft Sentinel based on the watchlist alias, display name, item search key, provider, source, workspace subscription ID, workspace resource group, workspace name, and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672638683,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7700dfce-0729-44f8-9277-b9ff457750a4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4a8e517e-58a8-4cf6-9872-258420e67d62",
                "title": "Microsoft Sentinel: Update Watchlist",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7700dfce-0729-44f8-9277-b9ff457750a4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Watchlist",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "etag": "",
                  "source": "Microsoft",
                  "provider": "Local file",
                  "description": "",
                  "displayName": "High Value Assets Watchlist",
                  "itemsSearchKey": "Header",
                  "watchlistAlias": "highValueAsset",
                  "custom_attributes": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_watchlist",
                "operationTitle": "Update Watchlist",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "4104a7ff-b196-4749-9001-e43efdc1c988"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Watchlist",
              "targetStep": "/api/3/workflow_steps/4104a7ff-b196-4749-9001-e43efdc1c988",
              "sourceStep": "/api/3/workflow_steps/7700dfce-0729-44f8-9277-b9ff457750a4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "97202f5a-ffbb-4a2c-934a-303f7eb8712c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "972e1925-802c-421b-9395-ad6b147857a7",
          "id": 711,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Watchlist Item",
          "aliasName": null,
          "tag": null,
          "description": "Updates an watchlist item in Microsoft Sentinel based on the watchlist item ID, watchlist alias, item key value, workspace subscription ID, workspace resource group, workspace name, and other input parameters that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672639276,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/44f6a4f6-d106-4a32-89b5-22400a7a7e77",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "e1e0f347-1455-4dba-9e15-5d72bede0397",
                "title": "Microsoft Sentinel: Update Watchlist Item",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "44f6a4f6-d106-4a32-89b5-22400a7a7e77"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Watchlist Item",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "etag": "",
                  "itemsKeyValue": "{\n  \"Gateway subnet\": \"10.0.255.224/27\",\n  \"Web Tier\": \"10.0.1.0/24\",\n  \"Business tier\": \"10.0.2.0/24\",\n  \"Data tier\": \"10.0.2.0/24\",\n  \"Private DMZ in\": \"10.0.0.0/27\",\n  \"Public DMZ out\": \"10.0.0.96/27\"\n}",
                  "watchlistAlias": "highValueAsset",
                  "watchlistItemId": "3f8901fe-63d9-4875-9ad5-9fb3b8105797",
                  "custom_attributes": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_watchlist_item",
                "operationTitle": "Update Watchlist Item",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "20977bcd-2cf9-4d7e-9710-9dbf48b6d3e5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Watchlist Item",
              "targetStep": "/api/3/workflow_steps/20977bcd-2cf9-4d7e-9710-9dbf48b6d3e5",
              "sourceStep": "/api/3/workflow_steps/44f6a4f6-d106-4a32-89b5-22400a7a7e77",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f8b128de-95ca-4813-ba9b-0b702139d7f2"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9cf9b558-561f-45dd-9c3c-61f61fad8a47",
          "id": 712,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Comment",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a specific comment of a incident from Microsoft Sentinel based on the incident comment ID, incident ID, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207569,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2ed40b27-96b7-4fec-87bb-c30852862acd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Comment",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "incidentcommentId": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident_comment",
                "operationTitle": "Get Incident Comment",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3d41e6a7-6a26-4b04-963b-100855243726"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "900eb88d-8aaa-4c05-93e8-55c2d7e8f9ab",
                "title": "Microsoft Sentinel: Get Incident Comment",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "2ed40b27-96b7-4fec-87bb-c30852862acd"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Comment",
              "targetStep": "/api/3/workflow_steps/3d41e6a7-6a26-4b04-963b-100855243726",
              "sourceStep": "/api/3/workflow_steps/2ed40b27-96b7-4fec-87bb-c30852862acd",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f1f13997-d151-4d09-beac-59818fb8d3c0"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "a2f75f28-2ed8-4b3b-837a-7bf198bae0c9",
          "id": 713,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get All Threat Intelligence Indicators",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all threat intelligence indicators from Microsoft Sentinel based on the workspace subscription ID, workspace resource group, workspace name, and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1677045786,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7fdb39fa-4f4b-4c5a-ae3c-01d7d81fee61",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Threat Intelligence Indicators",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$top": "",
                  "$filter": "",
                  "$orderby": "",
                  "$skipToken": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_threat_intelligence_indicators",
                "operationTitle": "Get All Threat Intelligence Indicators",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9dd62349-0f4a-49ae-a84e-18f3a354460c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "5eff9f19-eaa4-400d-8900-62106012c72d",
                "title": "Microsoft Sentinel: Get All Threat Intelligence Indicators",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7fdb39fa-4f4b-4c5a-ae3c-01d7d81fee61"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Threat Intelligence Indicators",
              "targetStep": "/api/3/workflow_steps/9dd62349-0f4a-49ae-a84e-18f3a354460c",
              "sourceStep": "/api/3/workflow_steps/7fdb39fa-4f4b-4c5a-ae3c-01d7d81fee61",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "027da6d2-14be-4f56-906f-984ceedbebed"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "a478ffbe-4a0c-429f-abb5-72f030f17053",
          "id": 714,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Incident Comment",
          "aliasName": null,
          "tag": null,
          "description": "Deletes a specific incident comment in Microsoft Sentinel based on the incident comment ID, incident ID, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207785,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9b4097f2-972f-4a99-aed9-94dc6e3d26f2",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Incident Comment",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "incidentcommentId": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "delete_incident_comment",
                "operationTitle": "Delete Incident Comment",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f7ea100e-833d-4221-97cc-7d64eebe8732"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0d8796a9-bc7e-4805-add2-eebae27ec7ce",
                "title": "Microsoft Sentinel: Delete Incident Comment",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "9b4097f2-972f-4a99-aed9-94dc6e3d26f2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Incident Comment",
              "targetStep": "/api/3/workflow_steps/f7ea100e-833d-4221-97cc-7d64eebe8732",
              "sourceStep": "/api/3/workflow_steps/9b4097f2-972f-4a99-aed9-94dc6e3d26f2",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "97226b23-cab5-4731-b177-b7aa3ed83c84"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "af6026ed-2667-4c93-bbf5-c5b28876b8bc",
          "id": 715,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Watchlist Item",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a specific watchlist item from Microsoft Sentinel based on the watchlist item ID, watchlist alias, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672639133,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/15d96830-6c0d-4b19-9356-3b00c6c528fa",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Watchlist Item",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "watchlistAlias": "highValueAsset",
                  "watchlistItemId": "3f8901fe-63d9-4875-9ad5-9fb3b8105797"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_watchlist_item",
                "operationTitle": "Get Watchlist Item",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2aaeffe9-0668-4691-9c19-29d654c323ed"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "181ab7f6-7b37-45b1-9c5b-45a9641742aa",
                "title": "Microsoft Sentinel: Get Watchlist Item",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "15d96830-6c0d-4b19-9356-3b00c6c528fa"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Watchlist Item",
              "targetStep": "/api/3/workflow_steps/2aaeffe9-0668-4691-9c19-29d654c323ed",
              "sourceStep": "/api/3/workflow_steps/15d96830-6c0d-4b19-9356-3b00c6c528fa",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "392134bb-710d-4907-b76d-3127502aeb08"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "b7534939-a911-45b0-ac4e-587b923f3f76",
          "id": 716,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Bookmarks List",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves an bookmarks associated with a specific incident from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672206160,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a5396a55-f85c-4ce6-8699-5670c7513975",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Bookmarks List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_bookmarks_list",
                "operationTitle": "Get Incident Bookmarks List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6e5c9d96-e5bd-41da-9c86-5802b27df701"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "88e01041-1990-4f39-b5cd-cbc2f48a5a81",
                "title": "Microsoft Sentinel: Get Incident Bookmarks List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a5396a55-f85c-4ce6-8699-5670c7513975"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Bookmarks List",
              "targetStep": "/api/3/workflow_steps/6e5c9d96-e5bd-41da-9c86-5802b27df701",
              "sourceStep": "/api/3/workflow_steps/a5396a55-f85c-4ce6-8699-5670c7513975",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b906d4a1-4463-4e0f-afe4-fed629013c4d"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "b88d8b6e-bd13-4288-9aea-27734e990d89",
          "id": 717,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Watchlist",
          "aliasName": null,
          "tag": null,
          "description": "Deletes a specific watchlist in Microsoft Sentinel based on the watchlist alias, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672638777,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/80d122cd-726e-40ce-a5e9-75f0749fd384",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Watchlist",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "relationName": "highValueAsset"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "delete_watchlist",
                "operationTitle": "Delete Watchlist",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "5c11beca-e633-4a85-a8f5-9adbe0ec412e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "21d7cee5-3346-437b-8b8e-bc98fd30729d",
                "title": "Microsoft Sentinel: Delete Watchlist",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "80d122cd-726e-40ce-a5e9-75f0749fd384"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Watchlist",
              "targetStep": "/api/3/workflow_steps/5c11beca-e633-4a85-a8f5-9adbe0ec412e",
              "sourceStep": "/api/3/workflow_steps/80d122cd-726e-40ce-a5e9-75f0749fd384",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "76bd6f48-3260-432e-80f8-8b060e92932f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "bf695c0f-3c70-49b3-a2ff-3327f6adefaa",
          "id": 719,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Threat Intelligence Indicator",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves a specific threat intelligence indicator from Microsoft Sentinel based on the threat intelligence indicator ID, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672205278,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/28496036-b528-40c9-9050-1497f93ff1a3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Threat Intelligence Indicator",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "id": "e16ef847-962e-d7b6-9c8b-a33e4bd30e47"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_threat_intelligence_indicator",
                "operationTitle": "Get Threat Intelligence Indicator",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8404465c-0100-4c6b-9238-0e7ebf3a714a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "a8e8d260-3728-4dd8-8553-083b9be6ddad",
                "title": "Microsoft Sentinel: Get Threat Intelligence Indicator",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "28496036-b528-40c9-9050-1497f93ff1a3"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Threat Intelligence Indicator",
              "targetStep": "/api/3/workflow_steps/8404465c-0100-4c6b-9238-0e7ebf3a714a",
              "sourceStep": "/api/3/workflow_steps/28496036-b528-40c9-9050-1497f93ff1a3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1add5766-3bc9-46e6-a1d0-ead182ade1f6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "c0975faa-a3a2-4e53-9b23-46f78dbbf4be",
          "id": 720,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Details",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves an specific incident from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672205903,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/95cf092f-dbac-499e-a332-b5a3da70d350",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Details",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident",
                "operationTitle": "Get Incident Details",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2a7d9928-c611-4cfa-bf05-8a72a24657d9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "7a7afece-075a-459d-a28d-5a828100bb5e",
                "title": "Microsoft Sentinel: Get Incident Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "95cf092f-dbac-499e-a332-b5a3da70d350"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Details",
              "targetStep": "/api/3/workflow_steps/2a7d9928-c611-4cfa-bf05-8a72a24657d9",
              "sourceStep": "/api/3/workflow_steps/95cf092f-dbac-499e-a332-b5a3da70d350",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a486db0a-7008-46d1-9ed8-9794533b1eef"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "c0de2fe1-6521-46ec-adaf-600f32ffd309",
          "id": 721,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get All Watchlist Items",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all watchlist items from Microsoft Sentinel based on the workspace subscription ID, workspace resource group, workspace name, and other input parameter you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672639044,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/cc5b8574-ab5e-46a2-84ab-f9547b03414b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Watchlist Items",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$skipToken": "",
                  "watchlistAlias": "highValueAsset"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_watchlist_items",
                "operationTitle": "Get All Watchlist Items",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7f36591f-c681-41e3-8d09-411a72313c40"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "2823cb8b-6260-49f1-afb5-dfc26ba5dd85",
                "title": "Microsoft Sentinel: Get All Watchlist Items",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "cc5b8574-ab5e-46a2-84ab-f9547b03414b"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Watchlist Items",
              "targetStep": "/api/3/workflow_steps/7f36591f-c681-41e3-8d09-411a72313c40",
              "sourceStep": "/api/3/workflow_steps/cc5b8574-ab5e-46a2-84ab-f9547b03414b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4cdf8cb2-8928-47f6-8f98-417aa72fbfe6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cad7c746-7290-4906-a4c0-af9c0b657973",
          "id": 722,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Incident Relations",
          "aliasName": null,
          "tag": null,
          "description": "Updates an incident relations in Microsoft Sentinel based on the incident ID, relation name, resource ID, workspace subscription ID, workspace resource group, and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207093,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a42e2676-48e8-4e22-8d1c-d853b1dd38a8",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "be9fbc24-f034-45f4-8df7-36768f7c22ca",
                "title": "Microsoft Sentinel: Update Incident Relations",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a42e2676-48e8-4e22-8d1c-d853b1dd38a8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Incident Relations",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "resourceId": "/subscriptions/6212c9c8-54a6-41ee-846b-37727030c040/resourceGroups/fortinet-pune/providers/Microsoft.OperationalInsights/workspaces/FortiSOAR-Integration/providers/Microsoft.SecurityInsights/bookmarks/2216d0e1-91e3-4902-89fd-d2df8c535096",
                  "relationName": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "update_incident_relations",
                "operationTitle": "Update Incident Relations",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2707a795-6189-45bd-8df3-f4af4d483734"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Incident Relations",
              "targetStep": "/api/3/workflow_steps/2707a795-6189-45bd-8df3-f4af4d483734",
              "sourceStep": "/api/3/workflow_steps/a42e2676-48e8-4e22-8d1c-d853b1dd38a8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8c1cfac9-de0a-48d7-8f69-4ab9abb5e8bb"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "d53d5c45-c7bb-44f4-98b8-ee1b9fc38ec4",
          "id": 724,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Microsoft Sentinel > Fetch Incidents",
          "aliasName": null,
          "tag": null,
          "description": "Fetches all incidents from Microsoft Sentinel based on the input parameters you have specified.",
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1717664887,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/14965e3a-2d98-4bbb-975a-cacdf38ec00f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "top": 1000,
                "Pull_Sample_Events_in_Past_X_Minutes": "99999"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b031963e-e343-41fd-8bd1-7e06be445da4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "$top": "{{vars.top}}",
                  "Status": "{{vars.Status}}",
                  "$filter": "",
                  "$orderby": "",
                  "Severity": "{{vars.Severity}}",
                  "$skipToken": "",
                  "created_datetime": "{{vars.last_pull_time}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_incident_list",
                "operationTitle": "Get Incident List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "858618e1-3771-47de-9a01-04b2c1686b0c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.MicrosoftSentinelLastIncidentPullTime}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "bde7dd60-ec75-4d9a-95c7-ab303a2efbb7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Save Result",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Get_Incident_List.data.get(\"value\", [])}}",
                "macro_name": "{{vars.MicrosoftSentinelLastIncidentPullTime}}",
                "curr_timestamp": "{{vars.curr_timestamp}}"
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "816412c6-18a6-457d-a5dc-b437c897fae1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "curr_timestamp": "{{arrow.get(arrow.utcnow().int_timestamp).strftime('%Y-%m-%dT%H:%M:%S.%fZ')}}",
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.Pull_Sample_Events_in_Past_X_Minutes).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "66a33465-1786-4b8f-98c6-aba67dd1af96"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Incidents from Last X Minutes\",\n    \"name\": \"Pull_Sample_Events_in_Past_X_Minutes\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch incidents from last X minutes. e.g 10\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 10\n  },\n  {\n    \"title\": \"Severity\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"select\",\n    \"name\": \"Severity\",\n    \"description\": \"(Optional) Specify a severity for the specific incident based on which you want to retrieve from Microsoft Sentinel. You can choose from the following options: Critical, High, Medium, Low, or Informational.\",\n    \"options\": [\n      \"High\",\n      \"Medium\",\n      \"Low\",\n      \"Informational\"\n    ]\n  },\n  {\n    \"title\": \"Status\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"select\",\n    \"name\": \"Status\",\n    \"description\": \"(Optional) Specify a status for the specific incident based on which you want to retrieve from Microsoft Sentinel. You can choose from the following options: Active, New, or Closed.\",\n    \"options\": [\n      \"Active\",\n      \"New\",\n      \"Closed\"\n    ]\n  },\n  {\n    \"title\": \"Number of Incidents to Fetch\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"integer\",\n    \"value\": 1000,\n    \"name\": \"top\",\n    \"description\": \"(Optional) Maximum number of incidents that this operation should return from Microsoft Sentinel.\",\n    \"tooltip\": \"Note: If field is not provided ,then it pull only 50 incidents.\"\n  }\n]",
                  "MicrosoftSentinelLastIncidentPullTime": "MicrosoftSentinelLastIncidentPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "14965e3a-2d98-4bbb-975a-cacdf38ec00f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/bde7dd60-ec75-4d9a-95c7-ab303a2efbb7",
              "sourceStep": "/api/3/workflow_steps/b031963e-e343-41fd-8bd1-7e06be445da4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e5dc45b1-e776-40ca-a57e-3429c7815600"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident List1 -> Save Result",
              "targetStep": "/api/3/workflow_steps/816412c6-18a6-457d-a5dc-b437c897fae1",
              "sourceStep": "/api/3/workflow_steps/858618e1-3771-47de-9a01-04b2c1686b0c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1b5ec024-7aec-4e19-b111-908532205485"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/66a33465-1786-4b8f-98c6-aba67dd1af96",
              "sourceStep": "/api/3/workflow_steps/bde7dd60-ec75-4d9a-95c7-ab303a2efbb7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b81b29dc-674d-4ced-afab-25a9b015519c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Get Incident List1",
              "targetStep": "/api/3/workflow_steps/858618e1-3771-47de-9a01-04b2c1686b0c",
              "sourceStep": "/api/3/workflow_steps/66a33465-1786-4b8f-98c6-aba67dd1af96",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "57b54699-3765-4f99-8232-1621f8777844"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/b031963e-e343-41fd-8bd1-7e06be445da4",
              "sourceStep": "/api/3/workflow_steps/14965e3a-2d98-4bbb-975a-cacdf38ec00f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5360bd4c-a822-4b5c-9ee9-a9bffc5bfd1d"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e2a70cf7-339e-4886-8cbd-3bd7c0fa8131",
          "id": 729,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Incident Relations",
          "aliasName": null,
          "tag": null,
          "description": "Creates a incident relations in Microsoft Sentinel based on the incident ID, relation name, resource ID, workspace subscription ID, workspace resource group, and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672207118,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/53d91333-c7e0-4f3d-96ba-ba4524cdd5ea",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Incident Relations",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7",
                  "resourceId": "/subscriptions/6212c9c8-54a6-41ee-846b-37727030c040/resourceGroups/fortinet-pune/providers/Microsoft.OperationalInsights/workspaces/FortiSOAR-Integration/providers/Microsoft.SecurityInsights/bookmarks/2216d0e1-91e3-4902-89fd-d2df8c535096",
                  "relationName": "4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "create_incident_relations",
                "operationTitle": "Create Incident Relations",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e4aa85c7-2ba1-4537-9c85-4b3e88d0b54d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0bf96e29-1007-424b-b04e-c55aaf9aee49",
                "title": "Microsoft Sentinel: Create Incident Relations",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "53d91333-c7e0-4f3d-96ba-ba4524cdd5ea"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Incident Relations",
              "targetStep": "/api/3/workflow_steps/e4aa85c7-2ba1-4537-9c85-4b3e88d0b54d",
              "sourceStep": "/api/3/workflow_steps/53d91333-c7e0-4f3d-96ba-ba4524cdd5ea",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "dbd0e323-cfdf-4a8c-bcf5-1411548005b7"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e8f5053e-d8d6-4ad9-b2bf-eb9065ca6e37",
          "id": 725,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident Bidirectional Sync",
          "aliasName": null,
          "tag": null,
          "description": "Synchronize incident attributes between FortiSOAR and MS Sentinel",
          "isActive": false,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1718293823,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/68da690c-cb38-4256-9ecf-bbb5700667db",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "days_ago": "14"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "80e299f2-dd78-4e09-bf83-a024c8b83b49"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Incidents",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "datetime",
                      "logic": "AND",
                      "_field": "createDate",
                      "_value": "{{arrow.now().shift(days=-vars.days_ago).int_timestamp}}",
                      "filters": [
                        {
                          "type": "datetime",
                          "field": "createDate",
                          "value": "{{getRelativeDate(0,0,0,0,1,\"start\")}}",
                          "operator": "lt"
                        }
                      ],
                      "_operator": "lt"
                    },
                    {
                      "type": "primitive",
                      "field": "source",
                      "value": "Microsoft Sentinel",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "incidents?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "group": null,
              "uuid": "ab0c41ac-b9ba-4347-b870-30d7c13b9d71"
            },
            {
              "@type": "WorkflowStep",
              "name": "Incident Bidirectional Sync",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Find_Incidents}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "fortisoar_incident_data": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/575a1d8b-76b4-432c-9712-fc3b31f9dcbf"
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "82f91fc1-3709-4aed-9147-bc8414b08f63"
            },
            {
              "@type": "WorkflowStep",
              "name": "Incidents Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/82f91fc1-3709-4aed-9147-bc8414b08f63",
                    "condition": "{{ vars.steps.Find_Incidents | length > 0 }}",
                    "step_name": "Incident Bidirectional Sync"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/7f424497-bccd-48ef-9c32-9f76b7ab3642",
                    "step_name": "Stop"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "bebb06f5-bd41-4438-a8c9-7f5901f02a61"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "5d2381c1-27ca-4d09-bfc4-a5a8578b460a",
                "resources": [
                  "incidents"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "triggerOnSource": true,
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                  "visible": false,
                  "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "68da690c-cb38-4256-9ecf-bbb5700667db"
            },
            {
              "@type": "WorkflowStep",
              "name": "Stop",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.3.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "7f424497-bccd-48ef-9c32-9f76b7ab3642"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Find Incidents",
              "targetStep": "/api/3/workflow_steps/ab0c41ac-b9ba-4347-b870-30d7c13b9d71",
              "sourceStep": "/api/3/workflow_steps/80e299f2-dd78-4e09-bf83-a024c8b83b49",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "cf5f85f4-8b23-4f8f-acb4-216dc1e7bb02"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Incidents -> Incidents Found",
              "targetStep": "/api/3/workflow_steps/bebb06f5-bd41-4438-a8c9-7f5901f02a61",
              "sourceStep": "/api/3/workflow_steps/ab0c41ac-b9ba-4347-b870-30d7c13b9d71",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3248d105-368a-4cb8-9bed-9f738af78b0e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Incidents Found -> Incident Bidirectional Sync",
              "targetStep": "/api/3/workflow_steps/82f91fc1-3709-4aed-9147-bc8414b08f63",
              "sourceStep": "/api/3/workflow_steps/bebb06f5-bd41-4438-a8c9-7f5901f02a61",
              "label": "yes",
              "isExecuted": false,
              "group": null,
              "uuid": "a6f95c16-cdc1-443e-87f1-fd8bd139545d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Incidents Found -> Stop",
              "targetStep": "/api/3/workflow_steps/7f424497-bccd-48ef-9c32-9f76b7ab3642",
              "sourceStep": "/api/3/workflow_steps/bebb06f5-bd41-4438-a8c9-7f5901f02a61",
              "label": "no",
              "isExecuted": false,
              "group": null,
              "uuid": "8b94e4f0-1ed6-4bea-9f30-3355840adffd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/80e299f2-dd78-4e09-bf83-a024c8b83b49",
              "sourceStep": "/api/3/workflow_steps/68da690c-cb38-4256-9ecf-bbb5700667db",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7f860095-8a92-4379-9cbb-0b62902e3e53"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ebb09f84-872d-4a4f-8237-9ad3a1af854d",
          "id": 764,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel",
            "UseCase"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Microsoft Sentinel > Fetch Incident Alerts",
          "aliasName": null,
          "tag": null,
          "description": "Fetch alerts for specified incident.",
          "isActive": true,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "incidentdata"
          ],
          "synchronous": false,
          "lastModifyDate": 1718024704,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/113f838c-2b98-45ea-9e10-476948a78027",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Append Incident List And Alert List",
              "description": null,
              "arguments": {
                "incident": "{{vars.input.params.incidentdata.alerts}}",
                "_alerts_iocs": "{%set _indicators = vars.input.params.incidentdata.alerts|json_query(\"[].indicators[]\")%}\n{%if _indicators and _indicators|length > 0%}\n{{vars.alerts_iocs.extend(_indicators)}}\n{%endif%}",
                "list_incident": "{{vars.input.params['incidentdata']}}",
                "incident_status_map": "{'Active': {{'IncidentStatus' | picklist('In Progress') }}, 'Closed': {{'IncidentStatus' | picklist('Resolved') }}, 'New': {{'IncidentStatus'| picklist('Open') }}}",
                "incident_severity_map": "{'Informational': {{'Severity' | picklist('Minimal') }}, 'Low': {{'Severity' | picklist('Low') }}, 'Medium': {{'Severity' | picklist('Medium') }}, 'High': {{'Severity'| picklist('High') }}}"
              },
              "status": null,
              "top": "1080",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c7d2b7fb-3050-4cd1-b017-95b2917122aa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "indicators": "[]",
                "alerts_iocs": "[]",
                "queries_list": "[]",
                "indicator_map": "{\n  \"name\":\"User\",\n  \"aadTenantId\":\"User\",\n  \"sid\":\"User\",\n  \"dnsDomain\":\"Host\",\n  \"hostName\":\"Host\",\n  \"address\":\"IP Address\",\n  \"url\":\"URL\",\n  \"domainName\":\"Domain\",\n  \"directory\":\"File\",\n  \"algorithm\":\"FileHash-SHA256\",\n  \"processId\":\"Process\",\n  \"commandLine\":\"Process\",\n  \"elevationToken\":\"Process\",\n  \"hive\":\"Registry\",\n  \"mailboxPrimaryAddress\":\"Email Address\"\n}",
                "useMockOutput": "False"
              },
              "status": null,
              "top": "160",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "547c10b5-f6bc-4a13-a86b-2872f2d88f18"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Comments",
              "description": null,
              "arguments": {
                "when": "{{vars.input.params.incidentdata.comments | length > 0}}",
                "for_each": {
                  "item": "{{vars.input.params.incidentdata.comments}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>{{vars.item.properties.message}}</p>",
                  "__replace": "",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1320",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "96a1fbc9-94e2-4479-a22d-8f21ac96cc0e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Indicators",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.alerts_iocs|unique}}",
                  "__bulk": true,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "tlp": "/api/3/picklists/7bff95b7-6438-4b01-b23a-0fe8cb5b33d3",
                  "value": "{{vars.item.value}}",
                  "__replace": "false",
                  "indicatorStatus": "/api/3/picklists/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                  "typeofindicator": "{{\"IndicatorType\" | picklist(vars.item.type, \"@id\")}}",
                  "enrichmentStatus": "/api/3/picklists/a6d9da29-27b1-4b8a-965d-8d91518540d5"
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1440",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "1a8e3915-03c6-4306-9b09-c5fd018c2afa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "{{vars.list_incident.properties.title}}",
                  "phase": "/api/3/picklists/bb740542-f699-11e7-8c3f-9a214cf093ae",
                  "resSla": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "source": "Microsoft Sentinel",
                  "status": "{{vars.list_incident.properties.status | resolveRange(vars.incident_status_map)}}",
                  "category": "/api/3/picklists/703218fc-f69a-11e7-8c3f-9a214cf093ae",
                  "comments": "{{vars.steps.Create_Comments|json_query(\"[][\\\"@id\\\"][]\")}}",
                  "severity": "{{vars.list_incident.properties.severity | resolveRange(vars.incident_severity_map)}}",
                  "slaState": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "sourceId": "{{vars.list_incident.name}}",
                  "__replace": "true",
                  "indicators": "{{vars.steps.Create_Indicators|json_query(\"[][\\\"@id\\\"][]\")}}",
                  "sourcedata": "{{vars.list_incident | toJSON}}",
                  "description": "{{vars.list_incident.properties.description}}",
                  "slaPercentage": 0
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/incidents",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1560",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "d5c853f5-4344-4d69-b70f-aa07b93b9eb3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Entities",
              "description": null,
              "arguments": {
                "_entities": "{% if vars.entities %}\n{%for entity in vars.entities%}\n{%for k,v in entity.items()%}\n{%if k not in [\"friendlyName\"]%}\n{{vars.alerts_iocs.append({\"type\":vars.indicator_map.get(k),\"value\":v})}}\n{%endif%}\n{%endfor%}\n{%endfor%}\n{%endif%}"
              },
              "status": null,
              "top": "960",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "cdb456be-8483-4aae-99b5-07fdb71cd308"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Alert Related Events",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Incident_Alert_List.data.value}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "alert": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/8fe7c198-96a0-4a8b-b0ea-88e13c44cc59"
              },
              "status": null,
              "top": "680",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "071b14ce-1703-4b15-801d-083bcb759ec8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Alert List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "incidentId": "{{vars.input.params.incidentdata.name}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_alert_list",
                "mock_result": "{\n  \"data\": {\n    \"value\": [\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n        \"kind\": \"SecurityAlert\",\n        \"name\": \"38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"status\": \"New\",\n          \"tactics\": [\n            \"CommandAndControl\"\n          ],\n          \"severity\": \"High\",\n          \"alertType\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b_801aba4c-f0a1-45bf-9911-10be3f4a62d4\",\n          \"endTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"vendorName\": \"Microsoft\",\n          \"description\": \"Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.\\n References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, \\n https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1\",\n          \"productName\": \"Azure Sentinel\",\n          \"friendlyName\": \"Solorigate Network Beacon\",\n          \"startTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"systemAlertId\": \"38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n          \"timeGenerated\": \"2024-05-27T17:04:51.8766808Z\",\n          \"additionalData\": {\n            \"OriginalProductName\": \"Azure Sentinel\",\n            \"AlertMessageEnqueueTime\": \"2024-05-27T17:04:51.926Z\",\n            \"OriginalProductComponentName\": \"Scheduled Alerts\",\n            \"Search Query Results Overall Count\": \"1\"\n          },\n          \"confidenceLevel\": \"Unknown\",\n          \"providerAlertId\": \"578821ad-913a-463b-962b-38d36a927fc7\",\n          \"alertDisplayName\": \"Solorigate Network Beacon\",\n          \"processingEndTime\": \"2024-05-27T17:04:51.8251437Z\",\n          \"resourceIdentifiers\": [\n            {\n              \"type\": \"LogAnalytics\",\n              \"workspaceId\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b\",\n              \"resourceGroup\": \"Sentinel-ResourceGroup\",\n              \"subscriptionId\": \"9ac687b2-9c41-41e0-9610-44b2b5b60a0e\"\n            }\n          ],\n          \"productComponentName\": \"Scheduled Alerts\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n        \"kind\": \"SecurityAlert\",\n        \"name\": \"8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"status\": \"New\",\n          \"tactics\": [\n            \"CommandAndControl\"\n          ],\n          \"severity\": \"High\",\n          \"alertType\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b_801aba4c-f0a1-45bf-9911-10be3f4a62d4\",\n          \"endTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"vendorName\": \"Microsoft\",\n          \"description\": \"Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.\\n References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, \\n https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1\",\n          \"productName\": \"Azure Sentinel\",\n          \"friendlyName\": \"Solorigate Network Beacon\",\n          \"startTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"systemAlertId\": \"8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n          \"timeGenerated\": \"2024-05-27T17:09:53.561503Z\",\n          \"additionalData\": {\n            \"OriginalProductName\": \"Azure Sentinel\",\n            \"AlertMessageEnqueueTime\": \"2024-05-27T17:09:53.566Z\",\n            \"OriginalProductComponentName\": \"Scheduled Alerts\",\n            \"Search Query Results Overall Count\": \"1\"\n          },\n          \"confidenceLevel\": \"Unknown\",\n          \"providerAlertId\": \"6e416946-8dc5-49f1-acdf-3ffda1264ad7\",\n          \"alertDisplayName\": \"Solorigate Network Beacon\",\n          \"processingEndTime\": \"2024-05-27T17:09:53.5162568Z\",\n          \"resourceIdentifiers\": [\n            {\n              \"type\": \"LogAnalytics\",\n              \"workspaceId\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b\",\n              \"resourceGroup\": \"Sentinel-ResourceGroup\",\n              \"subscriptionId\": \"9ac687b2-9c41-41e0-9610-44b2b5b60a0e\"\n            }\n          ],\n          \"productComponentName\": \"Scheduled Alerts\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n        \"kind\": \"SecurityAlert\",\n        \"name\": \"a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"status\": \"New\",\n          \"tactics\": [\n            \"CommandAndControl\"\n          ],\n          \"severity\": \"High\",\n          \"alertType\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b_801aba4c-f0a1-45bf-9911-10be3f4a62d4\",\n          \"endTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"vendorName\": \"Microsoft\",\n          \"description\": \"Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.\\n References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, \\n https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1\",\n          \"productName\": \"Azure Sentinel\",\n          \"friendlyName\": \"Solorigate Network Beacon\",\n          \"startTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"systemAlertId\": \"a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n          \"timeGenerated\": \"2024-05-27T17:14:55.4423979Z\",\n          \"additionalData\": {\n            \"OriginalProductName\": \"Azure Sentinel\",\n            \"AlertMessageEnqueueTime\": \"2024-05-27T17:14:55.48Z\",\n            \"OriginalProductComponentName\": \"Scheduled Alerts\",\n            \"Search Query Results Overall Count\": \"1\"\n          },\n          \"confidenceLevel\": \"Unknown\",\n          \"providerAlertId\": \"c039a998-ddde-4c54-85aa-ac9fb9ca7de6\",\n          \"alertDisplayName\": \"Solorigate Network Beacon\",\n          \"processingEndTime\": \"2024-05-27T17:14:55.4177334Z\",\n          \"resourceIdentifiers\": [\n            {\n              \"type\": \"LogAnalytics\",\n              \"workspaceId\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b\",\n              \"resourceGroup\": \"Sentinel-ResourceGroup\",\n              \"subscriptionId\": \"9ac687b2-9c41-41e0-9610-44b2b5b60a0e\"\n            }\n          ],\n          \"productComponentName\": \"Scheduled Alerts\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/11d64be3-399e-da8d-6246-88c493fb2303\",\n        \"kind\": \"SecurityAlert\",\n        \"name\": \"11d64be3-399e-da8d-6246-88c493fb2303\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"status\": \"New\",\n          \"tactics\": [\n            \"CommandAndControl\"\n          ],\n          \"severity\": \"High\",\n          \"alertType\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b_801aba4c-f0a1-45bf-9911-10be3f4a62d4\",\n          \"endTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"vendorName\": \"Microsoft\",\n          \"description\": \"Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.\\n References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, \\n https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1\",\n          \"productName\": \"Azure Sentinel\",\n          \"friendlyName\": \"Solorigate Network Beacon\",\n          \"startTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"systemAlertId\": \"11d64be3-399e-da8d-6246-88c493fb2303\",\n          \"timeGenerated\": \"2024-05-27T17:19:55.3246459Z\",\n          \"additionalData\": {\n            \"OriginalProductName\": \"Azure Sentinel\",\n            \"AlertMessageEnqueueTime\": \"2024-05-27T17:19:55.362Z\",\n            \"OriginalProductComponentName\": \"Scheduled Alerts\",\n            \"Search Query Results Overall Count\": \"1\"\n          },\n          \"confidenceLevel\": \"Unknown\",\n          \"providerAlertId\": \"0638a653-77cd-426c-ae90-c9183c014531\",\n          \"alertDisplayName\": \"Solorigate Network Beacon\",\n          \"processingEndTime\": \"2024-05-27T17:19:55.273927Z\",\n          \"resourceIdentifiers\": [\n            {\n              \"type\": \"LogAnalytics\",\n              \"workspaceId\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b\",\n              \"resourceGroup\": \"Sentinel-ResourceGroup\",\n              \"subscriptionId\": \"9ac687b2-9c41-41e0-9610-44b2b5b60a0e\"\n            }\n          ],\n          \"productComponentName\": \"Scheduled Alerts\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n        \"kind\": \"SecurityAlert\",\n        \"name\": \"c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"status\": \"New\",\n          \"tactics\": [\n            \"CommandAndControl\"\n          ],\n          \"severity\": \"High\",\n          \"alertType\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b_801aba4c-f0a1-45bf-9911-10be3f4a62d4\",\n          \"endTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"vendorName\": \"Microsoft\",\n          \"description\": \"Identifies a match across various data feeds for domains IOCs related to the Solorigate incident.\\n References: https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/, \\n https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html?1\",\n          \"productName\": \"Azure Sentinel\",\n          \"friendlyName\": \"Solorigate Network Beacon\",\n          \"startTimeUtc\": \"2024-05-27T16:53:48.4439412Z\",\n          \"systemAlertId\": \"c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n          \"timeGenerated\": \"2024-05-27T17:24:55.3299021Z\",\n          \"additionalData\": {\n            \"OriginalProductName\": \"Azure Sentinel\",\n            \"AlertMessageEnqueueTime\": \"2024-05-27T17:24:55.322Z\",\n            \"OriginalProductComponentName\": \"Scheduled Alerts\",\n            \"Search Query Results Overall Count\": \"1\"\n          },\n          \"confidenceLevel\": \"Unknown\",\n          \"providerAlertId\": \"2eeb94eb-0f89-46ca-8f9f-05971631cd66\",\n          \"alertDisplayName\": \"Solorigate Network Beacon\",\n          \"processingEndTime\": \"2024-05-27T17:24:55.2817105Z\",\n          \"resourceIdentifiers\": [\n            {\n              \"type\": \"LogAnalytics\",\n              \"workspaceId\": \"141db4fc-1f7f-4bb5-801f-f58ecd49360b\",\n              \"resourceGroup\": \"Sentinel-ResourceGroup\",\n              \"subscriptionId\": \"9ac687b2-9c41-41e0-9610-44b2b5b60a0e\"\n            }\n          ],\n          \"productComponentName\": \"Scheduled Alerts\"\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 539 ms\"\n}",
                "operationTitle": "Get Incident Alert List",
                "pickFromTenant": false,
                "step_variables": {
                  "alert_ids": "{{vars.steps.Get_Incident_Alert_List.data.value|yaql(\"$.name\")}}"
                }
              },
              "status": null,
              "top": "540",
              "left": "500",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a2760173-bf37-466a-b52c-d74337e26a32"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Bookmarks",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "incidentId": "{{vars.input.params.incidentdata.name}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_bookmarks_list",
                "mock_result": "{\n  \"data\": {\n    \"value\": []\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 327 ms\"\n}",
                "operationTitle": "Get Incident Bookmarks List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "280",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "35dfff48-0fc0-4092-be7d-fb053ec28588"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Comments",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "$top": 10,
                  "$filter": "",
                  "$orderby": "",
                  "$skipToken": "",
                  "incidentId": "{{vars.input.params.incidentdata.name}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_incident_comments",
                "mock_result": "{\n  \"data\": {\n    \"value\": [\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/Comments/8caddded-0e20-48cb-bbd3-9f455a4d030f\",\n        \"etag\": \"\\\"25009470-0000-3200-0000-665edf3a0000\\\"\",\n        \"name\": \"8caddded-0e20-48cb-bbd3-9f455a4d030f\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/Comments\",\n        \"properties\": {\n          \"author\": {\n            \"name\": \"Hany Badawy\",\n            \"email\": \"hany@hbforty.com\",\n            \"objectId\": \"fd5533e3-e598-4cd2-b962-07bd5f3c6b63\",\n            \"userPrincipalName\": \"hany@hbforty.com\"\n          },\n          \"message\": \"<p>A comment from UI</p><p><br></p>\",\n          \"createdTimeUtc\": \"2024-06-04T09:32:42.7323342Z\",\n          \"lastModifiedTimeUtc\": \"2024-06-04T09:32:42.7323342Z\"\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 222 ms\"\n}",
                "operationTitle": "Get All Incident Comments",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "540",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7ff93f60-89ef-455c-bb75-a1e274d4b684"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Entities",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "incidentId": "{{vars.input.params.incidentdata.name}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_entities_list",
                "mock_result": "{\n  \"data\": {\n    \"entities\": [\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/aa4cebf7-a493-f915-3cba-3d7de34e16fc\",\n        \"kind\": \"Ip\",\n        \"name\": \"aa4cebf7-a493-f915-3cba-3d7de34e16fc\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"address\": \"17.81.146.1\",\n          \"friendlyName\": \"17.81.146.1\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Entities/8fa75a20-deb5-0eb1-9db7-0ef158ef378f\",\n        \"kind\": \"DnsResolution\",\n        \"name\": \"8fa75a20-deb5-0eb1-9db7-0ef158ef378f\",\n        \"type\": \"Microsoft.SecurityInsights/Entities\",\n        \"properties\": {\n          \"domainName\": \"avsvmcloud.com\",\n          \"friendlyName\": \"avsvmcloud.com\"\n        }\n      }\n    ],\n    \"metaData\": [\n      {\n        \"count\": 1,\n        \"entityKind\": \"Ip\"\n      },\n      {\n        \"count\": 1,\n        \"entityKind\": \"DnsResolution\"\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 783 ms\"\n}",
                "operationTitle": "Get Incident Entities List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3e1948b3-edd8-4fd9-8cd6-e96c6eb0b782"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Relations",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "9a08b1b7-6271-49aa-8dca-de5a2776dce4",
                "params": {
                  "$top": "",
                  "$filter": "",
                  "$orderby": "",
                  "$skipToken": "",
                  "incidentId": "{{vars.input.params.incidentdata.name}}"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_incident_relations",
                "mock_result": "{\n  \"data\": {\n    \"value\": [\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/relations/fca6d89a-928e-2611-4943-39068664b56d_38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n        \"name\": \"fca6d89a-928e-2611-4943-39068664b56d_38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/relations\",\n        \"properties\": {\n          \"relatedResourceId\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/entities/38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n          \"relatedResourceKind\": \"SecurityAlert\",\n          \"relatedResourceName\": \"38f5ecce-27b7-a9f1-b4f0-0fc0ee8c5e68\",\n          \"relatedResourceType\": \"Microsoft.SecurityInsights/entities\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/relations/fca6d89a-928e-2611-4943-39068664b56d_8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n        \"name\": \"fca6d89a-928e-2611-4943-39068664b56d_8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/relations\",\n        \"properties\": {\n          \"relatedResourceId\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/entities/8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n          \"relatedResourceKind\": \"SecurityAlert\",\n          \"relatedResourceName\": \"8fba1fb6-24a7-9536-7138-0ed1bd22feff\",\n          \"relatedResourceType\": \"Microsoft.SecurityInsights/entities\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/relations/fca6d89a-928e-2611-4943-39068664b56d_a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n        \"name\": \"fca6d89a-928e-2611-4943-39068664b56d_a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/relations\",\n        \"properties\": {\n          \"relatedResourceId\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/entities/a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n          \"relatedResourceKind\": \"SecurityAlert\",\n          \"relatedResourceName\": \"a728b6af-6727-c1c5-8a64-8dd080ad8fef\",\n          \"relatedResourceType\": \"Microsoft.SecurityInsights/entities\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/relations/fca6d89a-928e-2611-4943-39068664b56d_11d64be3-399e-da8d-6246-88c493fb2303\",\n        \"name\": \"fca6d89a-928e-2611-4943-39068664b56d_11d64be3-399e-da8d-6246-88c493fb2303\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/relations\",\n        \"properties\": {\n          \"relatedResourceId\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/entities/11d64be3-399e-da8d-6246-88c493fb2303\",\n          \"relatedResourceKind\": \"SecurityAlert\",\n          \"relatedResourceName\": \"11d64be3-399e-da8d-6246-88c493fb2303\",\n          \"relatedResourceType\": \"Microsoft.SecurityInsights/entities\"\n        }\n      },\n      {\n        \"id\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/Incidents/fca6d89a-928e-2611-4943-39068664b56d/relations/fca6d89a-928e-2611-4943-39068664b56d_c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n        \"name\": \"fca6d89a-928e-2611-4943-39068664b56d_c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n        \"type\": \"Microsoft.SecurityInsights/Incidents/relations\",\n        \"properties\": {\n          \"relatedResourceId\": \"/subscriptions/9ac687b2-9c41-41e0-9610-44b2b5b60a0e/resourceGroups/Sentinel-ResourceGroup/providers/Microsoft.OperationalInsights/workspaces/Sentinel-Instance/providers/Microsoft.SecurityInsights/entities/c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n          \"relatedResourceKind\": \"SecurityAlert\",\n          \"relatedResourceName\": \"c5c2bacc-239c-7f03-2f0c-b111c95135d1\",\n          \"relatedResourceType\": \"Microsoft.SecurityInsights/entities\"\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null,\n  \"execution_time\": \"1 seconds 197 ms\"\n}",
                "operationTitle": "Get All Incident Relations",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "680",
              "left": "100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "02fd94fa-361b-4695-9e4c-b6204d34b492"
            },
            {
              "@type": "WorkflowStep",
              "name": "Process Results",
              "description": null,
              "arguments": {
                "entities": "{{vars.steps.Get_Incident_Entities.data.entities|yaql(\"$.properties\")}}",
                "_response": "{%if vars.steps.Get_Alert_Related_Events|length > 0%}{{vars.input.params['incidentdata'].update({'alerts': vars.steps.Get_Alert_Related_Events})}}{%endif%}\n{%if vars.steps.Get_Incident_Entities.data.entities|length > 0%}{{vars.input.params['incidentdata'].update({'entities': vars.steps.Get_Incident_Entities.data})}}{%endif%}\n{%if vars.steps.Get_Incident_Comments.data.value|length > 0%}{{vars.input.params['incidentdata'].update({'comments': vars.steps.Get_Incident_Comments.data.value})}}{%endif%}\n{%if vars.steps.Get_Incident_Relations.data.value|length > 0%}{{vars.input.params['incidentdata'].update({'relations': vars.steps.Get_Incident_Relations.data.value})}}{%endif%}\n{%if vars.steps.Get_Incident_Bookmarks.data.value|length > 0%}{{vars.input.params['incidentdata'].update({'bookmarks': vars.steps.Get_Incident_Bookmarks.data.value})}}{%endif%}"
              },
              "status": null,
              "top": "840",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "14975b05-d1b9-489d-82b2-99993aa36c99"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "113f838c-2b98-45ea-9e10-476948a78027"
            },
            {
              "@type": "WorkflowStep",
              "name": "Unified IOCs",
              "description": null,
              "arguments": {
                "alerts_iocs": "{{ vars.alerts_iocs | json_query('[?value != null]') | unique}}"
              },
              "status": null,
              "top": "1200",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ffd7accc-1df7-486e-b1d2-03da1a376139"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Append Incident List And Alert List -> Unified IOCs",
              "targetStep": "/api/3/workflow_steps/ffd7accc-1df7-486e-b1d2-03da1a376139",
              "sourceStep": "/api/3/workflow_steps/c7d2b7fb-3050-4cd1-b017-95b2917122aa",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f2bbdc3c-7088-4dcf-b716-e0a8968b95ac"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Incident Alert List",
              "targetStep": "/api/3/workflow_steps/a2760173-bf37-466a-b52c-d74337e26a32",
              "sourceStep": "/api/3/workflow_steps/547c10b5-f6bc-4a13-a86b-2872f2d88f18",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4c3717a5-9210-49f2-9003-01ff7e4b8ab2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Incident Bookmarks",
              "targetStep": "/api/3/workflow_steps/35dfff48-0fc0-4092-be7d-fb053ec28588",
              "sourceStep": "/api/3/workflow_steps/547c10b5-f6bc-4a13-a86b-2872f2d88f18",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4370dc87-993a-4098-9fd9-7acf2e5ab340"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Comments -> Create Indicators",
              "targetStep": "/api/3/workflow_steps/1a8e3915-03c6-4306-9b09-c5fd018c2afa",
              "sourceStep": "/api/3/workflow_steps/96a1fbc9-94e2-4479-a22d-8f21ac96cc0e",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b662b0ff-dbb9-462d-b423-e368677917f1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Indicators -> Create Record",
              "targetStep": "/api/3/workflow_steps/d5c853f5-4344-4d69-b70f-aa07b93b9eb3",
              "sourceStep": "/api/3/workflow_steps/1a8e3915-03c6-4306-9b09-c5fd018c2afa",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c0a340d9-77c5-4e47-986c-1ad2958ef5de"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Entities -> Append Incident List And Alert List",
              "targetStep": "/api/3/workflow_steps/c7d2b7fb-3050-4cd1-b017-95b2917122aa",
              "sourceStep": "/api/3/workflow_steps/cdb456be-8483-4aae-99b5-07fdb71cd308",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "39b47a7d-c63c-484f-8380-315034360d05"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Alert Related Events -> Process Results",
              "targetStep": "/api/3/workflow_steps/14975b05-d1b9-489d-82b2-99993aa36c99",
              "sourceStep": "/api/3/workflow_steps/071b14ce-1703-4b15-801d-083bcb759ec8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "201e259d-075b-4a47-a07e-13ca8eb3364a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Alert List -> Get Alert Related Events",
              "targetStep": "/api/3/workflow_steps/071b14ce-1703-4b15-801d-083bcb759ec8",
              "sourceStep": "/api/3/workflow_steps/a2760173-bf37-466a-b52c-d74337e26a32",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b8b39f59-22da-40fc-a145-2675ed0a17fe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Bookmarks -> Get Incident Entities",
              "targetStep": "/api/3/workflow_steps/3e1948b3-edd8-4fd9-8cd6-e96c6eb0b782",
              "sourceStep": "/api/3/workflow_steps/35dfff48-0fc0-4092-be7d-fb053ec28588",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8f7e37ee-438f-49cc-9955-6e8ff6ebbbb8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Comments -> Get Incident Relations",
              "targetStep": "/api/3/workflow_steps/02fd94fa-361b-4695-9e4c-b6204d34b492",
              "sourceStep": "/api/3/workflow_steps/7ff93f60-89ef-455c-bb75-a1e274d4b684",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e3e8e061-df0f-4629-878b-eb1d493b4673"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Entities -> Get Incident Comments",
              "targetStep": "/api/3/workflow_steps/7ff93f60-89ef-455c-bb75-a1e274d4b684",
              "sourceStep": "/api/3/workflow_steps/3e1948b3-edd8-4fd9-8cd6-e96c6eb0b782",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "709f95ab-88ec-43d6-a321-9daf3977ade4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Incident Relations -> Process Results",
              "targetStep": "/api/3/workflow_steps/14975b05-d1b9-489d-82b2-99993aa36c99",
              "sourceStep": "/api/3/workflow_steps/02fd94fa-361b-4695-9e4c-b6204d34b492",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "96ffdeed-051e-4e83-9d69-efc1601159f2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Process Results -> Extract Entities",
              "targetStep": "/api/3/workflow_steps/cdb456be-8483-4aae-99b5-07fdb71cd308",
              "sourceStep": "/api/3/workflow_steps/14975b05-d1b9-489d-82b2-99993aa36c99",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "088a3943-231e-4d6b-8ba4-f96ddb23aee8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/547c10b5-f6bc-4a13-a86b-2872f2d88f18",
              "sourceStep": "/api/3/workflow_steps/113f838c-2b98-45ea-9e10-476948a78027",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "aef55f7d-94ed-4e83-a02a-168e56b0ee26"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Unified IOCs -> Create Comments",
              "targetStep": "/api/3/workflow_steps/96a1fbc9-94e2-4479-a22d-8f21ac96cc0e",
              "sourceStep": "/api/3/workflow_steps/ffd7accc-1df7-486e-b1d2-03da1a376139",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6f044b5b-521e-4cf2-a971-c17cc604ceed"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ed191c7c-2cfb-4cea-bd10-36a9736d22f9",
          "id": 731,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "create",
            "dataingestion",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Incident Entities List",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all entities associated with a specific incident from Microsoft Sentinel based on the incident ID, workspace subscription ID, workspace name ID, workspace resource group, workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1676386331,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/68765b7d-a23d-463e-8d88-b0643e900345",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Entities List",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "incidentId": "62d2b57d-fe59-4ec5-b789-0e5cf4ff78b7"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_entities_list",
                "operationTitle": "Get Incident Entities List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "fef293df-9142-43fd-ac91-719f5d178dcd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "173e782a-8807-40ab-a791-8e1247b7451a",
                "title": "Microsoft Sentinel: Get Incident Entities List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "68765b7d-a23d-463e-8d88-b0643e900345"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Entities List",
              "targetStep": "/api/3/workflow_steps/fef293df-9142-43fd-ac91-719f5d178dcd",
              "sourceStep": "/api/3/workflow_steps/68765b7d-a23d-463e-8d88-b0643e900345",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e3a3600f-339e-4d60-92d4-ba1a13a60773"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f4a34344-b9fd-45b3-9097-0625ff327bcf",
          "id": 726,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Watchlist Item",
          "aliasName": null,
          "tag": null,
          "description": "Deletes a specific watchlist item in Microsoft Sentinel based on the watchlist item ID, watchlist alias, workspace subscription ID, workspace resource group and workspace name that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1672639364,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b872c93c-6ec9-4db0-abe0-9fdac4ccf508",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Watchlist Item",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "watchlistAlias": "highValueAsset",
                  "watchlistItemId": "82ba292c-dc97-4dfc-969d-d4dd9e666842"
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "delete_watchlist_item",
                "operationTitle": "Delete Watchlist Item",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a005b46a-1901-4250-8e3e-5b3d41138acc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "5266a9fb-4a8d-4156-855d-a22f88664b3d",
                "title": "Microsoft Sentinel: Delete Watchlist Item",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b872c93c-6ec9-4db0-abe0-9fdac4ccf508"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Watchlist Item",
              "targetStep": "/api/3/workflow_steps/a005b46a-1901-4250-8e3e-5b3d41138acc",
              "sourceStep": "/api/3/workflow_steps/b872c93c-6ec9-4db0-abe0-9fdac4ccf508",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "90146641-997b-4c4f-815a-364ed994f76c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f68de8d1-a3a3-4f70-aa8d-3a1f6e191717",
          "id": 727,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get All Watchlist",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all watchlist from Microsoft Sentinel based on the workspace subscription ID, workspace resource group, workspace name, and other input parameter you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1677043694,
          "collection": "/api/3/workflow_collections/8589641d-44c6-4319-b1ee-46d286522fe3",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6e8e890c-057f-4183-b7e2-22ec4c005af7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Watchlist",
              "description": null,
              "arguments": {
                "name": "Microsoft Sentinel",
                "config": "",
                "params": {
                  "$skipToken": ""
                },
                "version": "1.0.0",
                "connector": "microsoft-sentinel",
                "operation": "get_all_watchlist",
                "operationTitle": "Get All Watchlist",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c59bfbf3-4f96-40e5-885f-57f2ac223641"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1af52996-0345-4fe3-bf93-069563193ec4",
                "title": "Microsoft Sentinel: Get All Watchlist",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6e8e890c-057f-4183-b7e2-22ec4c005af7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Watchlist",
              "targetStep": "/api/3/workflow_steps/c59bfbf3-4f96-40e5-885f-57f2ac223641",
              "sourceStep": "/api/3/workflow_steps/6e8e890c-057f-4183-b7e2-22ec4c005af7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "365b2f1e-ad86-4021-9ce1-6dd1f8e6668c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ffbc41be-c852-4b73-96d8-3032e992f363",
          "id": 728,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Microsoft",
            "microsoft-sentinel"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "dataingestion",
    "ingest",
    "microsoft-sentinel",
    "Microsoft",
    "UseCase",
    "fetch",
    "create"
  ]
}